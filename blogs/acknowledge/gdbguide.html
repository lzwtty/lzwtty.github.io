<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>GDB调试手册 | 斯人如彩虹</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.ico">
    <script language="javascript" type="text/javascript" src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script language="javascript" type="text/javascript" src="/js/MouseClickEffect.js"></script>
    <meta name="description" content=" ">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.ece217d8.css" as="style"><link rel="preload" href="/assets/js/app.72629fdf.js" as="script"><link rel="preload" href="/assets/js/3.5a4097ad.js" as="script"><link rel="preload" href="/assets/js/1.e2979132.js" as="script"><link rel="preload" href="/assets/js/13.d8a01b18.js" as="script"><link rel="prefetch" href="/assets/js/10.e8bfcf7f.js"><link rel="prefetch" href="/assets/js/11.5733ddba.js"><link rel="prefetch" href="/assets/js/12.a2732e14.js"><link rel="prefetch" href="/assets/js/14.21bcebc4.js"><link rel="prefetch" href="/assets/js/15.cc9f2f8e.js"><link rel="prefetch" href="/assets/js/16.d264cc33.js"><link rel="prefetch" href="/assets/js/17.79a30f21.js"><link rel="prefetch" href="/assets/js/18.3b2b186e.js"><link rel="prefetch" href="/assets/js/19.876eee7d.js"><link rel="prefetch" href="/assets/js/20.9e432406.js"><link rel="prefetch" href="/assets/js/21.b160f907.js"><link rel="prefetch" href="/assets/js/22.b98bdf43.js"><link rel="prefetch" href="/assets/js/23.c61a42c5.js"><link rel="prefetch" href="/assets/js/24.3e59a9da.js"><link rel="prefetch" href="/assets/js/25.3423b9d6.js"><link rel="prefetch" href="/assets/js/26.14b116b2.js"><link rel="prefetch" href="/assets/js/27.946e74f9.js"><link rel="prefetch" href="/assets/js/28.33fa0677.js"><link rel="prefetch" href="/assets/js/29.6f72c1d3.js"><link rel="prefetch" href="/assets/js/30.f92ae4d6.js"><link rel="prefetch" href="/assets/js/31.3d8017d0.js"><link rel="prefetch" href="/assets/js/32.59e154c6.js"><link rel="prefetch" href="/assets/js/33.9c591539.js"><link rel="prefetch" href="/assets/js/4.735d6392.js"><link rel="prefetch" href="/assets/js/5.eb8174c0.js"><link rel="prefetch" href="/assets/js/6.6356d18d.js"><link rel="prefetch" href="/assets/js/7.2141c153.js"><link rel="prefetch" href="/assets/js/8.e3d6ceb6.js"><link rel="prefetch" href="/assets/js/9.973d1d99.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ece217d8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-1aefc0b4><div data-v-1aefc0b4><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-1aefc0b4 data-v-1aefc0b4><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-25ba6db2 data-v-1aefc0b4 data-v-1aefc0b4><h3 class="title" data-v-25ba6db2 data-v-25ba6db2>斯人如彩虹</h3> <p class="description" data-v-25ba6db2 data-v-25ba6db2> </p> <label id="box" class="inputBox" data-v-25ba6db2 data-v-25ba6db2><input type="password" value="" data-v-25ba6db2> <span data-v-25ba6db2>Konck! Knock!</span> <button data-v-25ba6db2>OK</button></label> <div class="footer" data-v-25ba6db2 data-v-25ba6db2><span data-v-25ba6db2><i class="iconfont reco-theme" data-v-25ba6db2></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-25ba6db2>vuePress-theme-reco</a></span> <span data-v-25ba6db2><i class="iconfont reco-copyright" data-v-25ba6db2></i> <a data-v-25ba6db2><span data-v-25ba6db2>lzwtty</span>
            
          <span data-v-25ba6db2>2020 - </span>
          2024
        </a></span></div></div> <div class="hide" data-v-1aefc0b4><header class="navbar" data-v-1aefc0b4><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="斯人如彩虹" class="logo"> <span class="site-name">斯人如彩虹</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/知识/" class="nav-link"><i class="undefined"></i>
  知识
</a></li><li class="dropdown-item"><!----> <a href="/categories/聊天/" class="nav-link"><i class="undefined"></i>
  聊天
</a></li><li class="dropdown-item"><!----> <a href="/categories/面经/" class="nav-link"><i class="undefined"></i>
  面经
</a></li><li class="dropdown-item"><!----> <a href="/categories/redis/" class="nav-link"><i class="undefined"></i>
  redis
</a></li><li class="dropdown-item"><!----> <a href="/categories/zmq/" class="nav-link"><i class="undefined"></i>
  zmq
</a></li><li class="dropdown-item"><!----> <a href="/categories/工作/" class="nav-link"><i class="undefined"></i>
  工作
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Docs
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/theme-reco/" class="nav-link"><i class="undefined"></i>
  vuepress-reco
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/lzwtty" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-1aefc0b4></div> <aside class="sidebar" data-v-1aefc0b4><div class="personal-info-wrapper" data-v-39576ba9 data-v-1aefc0b4><img src="/avatar.png" alt="author-avatar" class="personal-img" data-v-39576ba9> <h3 class="name" data-v-39576ba9>
    lzwtty
  </h3> <div class="num" data-v-39576ba9><div data-v-39576ba9><h3 data-v-39576ba9>23</h3> <h6 data-v-39576ba9>Articles</h6></div> <div data-v-39576ba9><h3 data-v-39576ba9>6</h3> <h6 data-v-39576ba9>Tags</h6></div></div> <ul class="social-links" data-v-39576ba9></ul> <hr data-v-39576ba9></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/知识/" class="nav-link"><i class="undefined"></i>
  知识
</a></li><li class="dropdown-item"><!----> <a href="/categories/聊天/" class="nav-link"><i class="undefined"></i>
  聊天
</a></li><li class="dropdown-item"><!----> <a href="/categories/面经/" class="nav-link"><i class="undefined"></i>
  面经
</a></li><li class="dropdown-item"><!----> <a href="/categories/redis/" class="nav-link"><i class="undefined"></i>
  redis
</a></li><li class="dropdown-item"><!----> <a href="/categories/zmq/" class="nav-link"><i class="undefined"></i>
  zmq
</a></li><li class="dropdown-item"><!----> <a href="/categories/工作/" class="nav-link"><i class="undefined"></i>
  工作
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Docs
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/theme-reco/" class="nav-link"><i class="undefined"></i>
  vuepress-reco
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/lzwtty" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-25ba6db2 data-v-1aefc0b4><h3 class="title" data-v-25ba6db2 data-v-25ba6db2>GDB调试手册</h3> <!----> <label id="box" class="inputBox" data-v-25ba6db2 data-v-25ba6db2><input type="password" value="" data-v-25ba6db2> <span data-v-25ba6db2>Konck! Knock!</span> <button data-v-25ba6db2>OK</button></label> <div class="footer" data-v-25ba6db2 data-v-25ba6db2><span data-v-25ba6db2><i class="iconfont reco-theme" data-v-25ba6db2></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-25ba6db2>vuePress-theme-reco</a></span> <span data-v-25ba6db2><i class="iconfont reco-copyright" data-v-25ba6db2></i> <a data-v-25ba6db2><span data-v-25ba6db2>lzwtty</span>
            
          <span data-v-25ba6db2>2020 - </span>
          2024
        </a></span></div></div> <div data-v-1aefc0b4><main class="page" style="padding-right:0;"><section><div class="page-title"><h1 class="title">GDB调试手册</h1> <div data-v-f875f3fc><i class="iconfont reco-account" data-v-f875f3fc><span data-v-f875f3fc>lzwtty</span></i> <i class="iconfont reco-date" data-v-f875f3fc><span data-v-f875f3fc>6/4/2022</span></i> <i class="iconfont reco-eye" data-v-f875f3fc><span id="/blogs/acknowledge/gdbguide.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-f875f3fc><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <i class="tags iconfont reco-tag" data-v-f875f3fc><span class="tag-item" data-v-f875f3fc>知识</span></i></div></div> <div class="theme-reco-content content__default"><p><strong>GDB调试手册</strong></p> <p><strong>目录</strong></p> <p><a href="#0-%E7%94%A8gdb%E8%B0%83%E8%AF%95%E7%A8%8B%E5%BA%8F">0 用GDB调试程序</a></p> <p><a href="#01gdb%E6%A6%82%E8%BF%B0">0.1 GDB概述</a></p> <p><a href="#02-%E8%B0%83%E8%AF%95%E7%A4%BA%E4%BE%8B">0.2 调试示例</a></p> <p><a href="#021-%E6%BA%90%E4%BB%A3%E7%A0%81test1c">0.2.1 源代码test1.c</a></p> <p><a href="#022-%E8%B0%83%E8%AF%95%E8%BF%87%E7%A8%8B">0.2.2 调试过程</a></p> <p><a href="#03-%E4%BD%BF%E7%94%A8gdb">0.3 使用GDB</a></p> <p><a href="#031-%E5%90%AF%E5%8A%A8gdb">0.3.1 启动GDB</a></p> <p><a href="#032gdb%E7%8E%AF%E5%A2%83%E4%B8%AD%E4%BD%BF%E7%94%A8shell%E5%91%BD%E4%BB%A4">0.3.2 GDB环境中使用shell命令</a></p> <p><a href="#033-%E5%9C%A8gdb%E4%B8%AD%E8%BF%90%E8%A1%8C%E7%A8%8B%E5%BA%8F">0.3.3 在GDB中运行程序</a></p> <p><a href="#1-%E8%AE%BE%E7%BD%AE%E6%96%AD%E7%82%B9">1 设置断点</a></p> <p><a href="#11-%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4">1.1 使用命令</a></p> <p><a href="#12-%E7%A4%BA%E4%BE%8B">1.2 示例</a></p> <p><a href="#121-%E8%B0%83%E8%AF%95%E8%BF%87%E7%A8%8B">1.2.1 调试过程</a></p> <p><a href="#2-%E7%A8%8B%E5%BA%8F%E7%9A%84%E5%8D%95%E6%AD%A5%E6%89%A7%E8%A1%8C">2 程序的单步执行</a></p> <p><a href="#21-%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4">2.1 使用命令</a></p> <p><a href="#22-%E7%A4%BA%E4%BE%8B">2.2 示例</a></p> <p><a href="#221-%E8%B0%83%E8%AF%95%E8%BF%87%E7%A8%8B">2.2.1 调试过程</a></p> <p><a href="#3-%E6%98%BE%E7%A4%BA%E4%BF%AE%E6%94%B9%E5%8F%98%E9%87%8F%E7%9A%84%E5%80%BC">3 显示/修改变量的值</a></p> <p><a href="#31%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4">3.1使用命令</a></p> <p><a href="#32%E7%A4%BA%E4%BE%8B">3.2示例</a></p> <p><a href="#321-%E6%BA%90%E4%BB%A3%E7%A0%81test2c">3.2.1 源代码test2.c</a></p> <p><a href="#322-%E8%B0%83%E8%AF%95%E8%BF%87%E7%A8%8B">3.2.2 调试过程</a></p> <p><a href="#4-%E7%9B%91%E8%A7%86%E7%A8%8B%E5%BA%8F%E5%8F%98%E9%87%8F%E5%80%BC">4 监视程序变量值</a></p> <p><a href="#41-%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4">4.1 使用命令</a></p> <p><a href="#42-%E7%A4%BA%E4%BE%8B">4.2 示例</a></p> <p><a href="#421-%E8%B0%83%E8%AF%95%E8%BF%87%E7%A8%8B">4.2.1 调试过程</a></p> <p><a href="#5-%E6%98%BE%E7%A4%BA%E4%BF%AE%E6%94%B9%E5%AF%84%E5%AD%98%E5%99%A8">5 显示/修改寄存器</a></p> <p><a href="#51-%E8%83%8C%E6%99%AF%E7%9F%A5%E8%AF%86">5.1 背景知识</a></p> <p><a href="#52-%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4">5.2 使用命令</a></p> <p><a href="#53-%E7%A4%BA%E4%BE%8B">5.3 示例</a></p> <p><a href="#521-%E8%B0%83%E8%AF%95%E8%BF%87%E7%A8%8B">5.2.1 调试过程</a></p> <p><a href="#6-%E6%9F%A5%E7%9C%8B%E7%A8%8B%E5%BA%8F%E7%9A%84%E5%A0%86%E6%A0%88">6 查看程序的堆栈</a></p> <p><a href="#61-%E8%83%8C%E6%99%AF%E7%9F%A5%E8%AF%86">6.1 背景知识</a></p> <p><a href="#62-%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4">6.2 使用命令</a></p> <p><a href="#63-%E7%A4%BA%E4%BE%8B">6.3 示例</a></p> <p><a href="#631-%E6%BA%90%E4%BB%A3%E7%A0%81test3c">6.3.1 源代码test3.c</a></p> <p><a href="#632-%E8%B0%83%E8%AF%95%E8%BF%87%E7%A8%8B">6.3.2 调试过程</a></p> <p><a href="#7-%E5%A4%9A%E7%BA%BF%E7%A8%8B%E8%B0%83%E8%AF%95">7 多线程调试</a></p> <p><a href="#71-%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4">7.1 使用命令</a></p> <p><a href="#72-%E7%A4%BA%E4%BE%8B">7.2 示例</a></p> <p><a href="#721-%E6%BA%90%E4%BB%A3%E7%A0%81test4c">7.2.1 源代码test4.c</a></p> <p><a href="#722-%E8%B0%83%E8%AF%95%E8%BF%87%E7%A8%8B">7.2.2 调试过程</a></p> <p><a href="#8-%E6%AD%BB%E9%94%81%E8%B0%83%E8%AF%95">8 死锁调试</a></p> <p><a href="#81-%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4">8.1 使用命令</a></p> <p><a href="#82-%E7%A4%BA%E4%BE%8B">8.2 示例</a></p> <p><a href="#821-%E6%BA%90%E6%96%87%E4%BB%B6test5c">8.2.1 源文件test5.c</a></p> <p><a href="#822-%E8%B0%83%E8%AF%95%E8%BF%87%E7%A8%8B">8.2.2 调试过程</a></p> <p><a href="#9-core%E6%96%87%E4%BB%B6%E8%B0%83%E8%AF%95">9 core文件调试</a></p> <p><a href="#91-%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4">9.1 使用命令</a></p> <p><a href="#92-%E7%A4%BA%E4%BE%8B">9.2 示例</a></p> <p><a href="#921-%E6%BA%90%E4%BB%A3%E7%A0%81test6c">9.2.1 源代码test6.c</a></p> <p><a href="#922-%E8%B0%83%E8%AF%95%E8%BF%87%E7%A8%8B">9.2.2 调试过程</a></p> <h1 id="_0-用gdb调试程序"><a href="#_0-用gdb调试程序" class="header-anchor">#</a> 0 用GDB调试程序</h1> <h2 id="_0-1-gdb概述"><a href="#_0-1-gdb概述" class="header-anchor">#</a> 0.1 GDB概述</h2> <p>GDB是GNU开源组织发布的一个强大的UNIX下的程序调试工具。或许，各位比较喜欢那种图形界面方式的，像VC、BCB等IDE的调试，但如果你是在UNIX平台下做软件，你会发现GDB这个调试工具有比VC、BCB的图形化调试器更强大的功能。所谓“寸有所长，尺有所短”就是这个道理。</p> <p>一般来说，GDB主要帮忙你完成下面四个方面的功能：</p> <p>1、启动你的程序，可以按照你的自定义的要求随心所欲的运行程序。</p> <p>2、调试的程序在你所指定的断点处停住。（断点可以是条件表达式）</p> <p>3、程序被停住时，可以检查此时你的程序中所发生的事。</p> <p>4、动态的改变你程序的执行环境。</p> <p>从上面看来，GDB和一般的调试工具没有什么两样，基本上也是完成这些功能，不过在细节上，你会发现GDB这个调试工具的强大，大家可能比较习惯了图形化的调试工具，但有时候，命令行的调试工具却有着图形化工具所不能完成的功能。让我们一一看来。</p> <h2 id="_0-2-调试示例"><a href="#_0-2-调试示例" class="header-anchor">#</a> 0.2 调试示例</h2> <h3 id="_0-2-1-源代码test1-c"><a href="#_0-2-1-源代码test1-c" class="header-anchor">#</a> 0.2.1 源代码test1.c</h3> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token number">1.</span>#include <span class="token operator">&lt;</span>stdio<span class="token punctuation">.</span>h<span class="token operator">&gt;</span>  
<span class="token number">2.</span>  
<span class="token number">3.</span><span class="token keyword">int</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span>  
<span class="token number">4.</span><span class="token punctuation">{</span>  
<span class="token number">5.</span>    <span class="token keyword">int</span> sum<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>i<span class="token punctuation">;</span>  
<span class="token number">6.</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>  
<span class="token number">7.</span>    <span class="token punctuation">{</span>     
<span class="token number">8.</span>        sum<span class="token operator">+=</span>i<span class="token punctuation">;</span>  
<span class="token number">9.</span>    <span class="token punctuation">}</span>     
<span class="token number">10.</span>    <span class="token keyword">return</span> sum<span class="token punctuation">;</span>  
<span class="token number">11.</span><span class="token punctuation">}</span>  
<span class="token number">12.</span>  
<span class="token number">13.</span>  
<span class="token number">14.</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
<span class="token number">15.</span><span class="token punctuation">{</span>  
<span class="token number">16.</span>    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  
<span class="token number">17.</span>    <span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  
<span class="token number">18.</span>    <span class="token keyword">int</span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  
<span class="token number">19.</span>    <span class="token keyword">int</span> m <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  
<span class="token number">20.</span>    <span class="token keyword">int</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token operator">&amp;</span>m<span class="token punctuation">;</span>   
<span class="token number">21.</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">&lt;=</span><span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>  
<span class="token number">22.</span>    <span class="token punctuation">{</span>     
<span class="token number">23.</span>        result <span class="token operator">+=</span> i<span class="token punctuation">;</span>  
<span class="token number">24.</span>             
<span class="token number">25.</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>  
<span class="token number">26.</span>        <span class="token punctuation">{</span>     
<span class="token number">27.</span>            m<span class="token operator">++</span><span class="token punctuation">;</span>  
<span class="token number">28.</span>        <span class="token punctuation">}</span>     
<span class="token number">29.</span>    <span class="token punctuation">}</span>     
<span class="token number">30.</span>  
<span class="token number">31.</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;result[1-100] = %d \n&quot;</span><span class="token punctuation">,</span> result <span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token number">32.</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;result[1-250] = %d \n&quot;</span><span class="token punctuation">,</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token number">33.</span>  
<span class="token number">34.</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>  
<span class="token number">35.</span><span class="token punctuation">}</span>  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h3 id="_0-2-2-调试过程"><a href="#_0-2-2-调试过程" class="header-anchor">#</a> 0.2.2 调试过程</h3> <p>编译生成执行文件：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>root@luo:~/workspace/test/ exec<span class="token punctuation">\</span><span class="token operator">&gt;</span>gcc -g test1.c -o test1
使用GDB调试：
root@luo:~/workspace/test/exec<span class="token punctuation">\</span><span class="token operator">&gt;</span>gdb test1-------------- 启动GDB
GNU gdb <span class="token punctuation">(</span>Wind River Linux Sourcery CodeBench <span class="token number">4.8</span>-45<span class="token punctuation">)</span> <span class="token number">7.6</span>
Copyright <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token number">2013</span> Free Software Foundation, Inc.
License GPLv3+: GNU GPL version <span class="token number">3</span> or later <span class="token operator">&lt;</span>http://gnu.org/licenses/gpl.html<span class="token operator">&gt;</span>
This is <span class="token function">free</span> software: you are <span class="token function">free</span> to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type <span class="token string">&quot;show copying&quot;</span>
and <span class="token string">&quot;show warranty&quot;</span> <span class="token keyword">for</span> details.
This GDB was configured as <span class="token string">&quot;x86_64-wrs-linux-gnu&quot;</span><span class="token builtin class-name">.</span>
For bug reporting instructions, please see:
<span class="token operator">&lt;</span>support@windriver.com<span class="token operator">&gt;</span><span class="token punctuation">..</span>.
Reading symbols from /home/luo/workspace/test/exec/test1<span class="token punctuation">..</span>.done.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> l <span class="token number">1</span>-------------- 从第一行开始列出源码，l为list缩写
<span class="token number">1</span>	<span class="token comment">#include &lt;stdio.h&gt;</span>
<span class="token number">2</span>	
<span class="token number">3</span>	int func<span class="token punctuation">(</span>int n<span class="token punctuation">)</span>
<span class="token number">4</span>	<span class="token punctuation">{</span>
<span class="token number">5</span>		int <span class="token assign-left variable">sum</span><span class="token operator">=</span><span class="token number">0</span>,i<span class="token punctuation">;</span>
<span class="token number">6</span>		for<span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>n<span class="token punctuation">;</span> i++<span class="token punctuation">)</span>
<span class="token number">7</span>		<span class="token punctuation">{</span>
<span class="token number">8</span>			<span class="token assign-left variable">sum</span><span class="token operator">+=</span>i<span class="token punctuation">;</span>
<span class="token number">9</span>		<span class="token punctuation">}</span>
<span class="token number">10</span>		<span class="token builtin class-name">return</span> <span class="token function">sum</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> -------------- 直接回车表示重复上一次命令
<span class="token number">11</span>	<span class="token punctuation">}</span>
<span class="token number">12</span>	
<span class="token number">13</span>	
<span class="token number">14</span>	int main<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token number">15</span>	<span class="token punctuation">{</span>
<span class="token number">16</span>		int i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token number">17</span>		int j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token number">18</span>		int result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token number">19</span>		int m <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token number">20</span>		int *p <span class="token operator">=</span> <span class="token operator">&amp;</span>m<span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token builtin class-name">break</span> <span class="token number">16</span> -------------- 设置断点，在源程序第16行
Breakpoint <span class="token number">1</span> at 0x400566: <span class="token function">file</span> test1.c, line <span class="token number">16</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token builtin class-name">break</span> func -------------- 设置断点，在func<span class="token punctuation">(</span><span class="token punctuation">)</span>函数入口处
Breakpoint <span class="token number">2</span> at 0x400537: <span class="token function">file</span> test1.c, line <span class="token number">5</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> info <span class="token builtin class-name">break</span> -------------- 显示断点信息
Num     Type           Disp Enb Address            What
<span class="token number">1</span>       breakpoint     keep y   0x0000000000400566 <span class="token keyword">in</span> main at test1.c:16
<span class="token number">2</span>       breakpoint     keep y   0x0000000000400537 <span class="token keyword">in</span> func at test1.c:5
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> r -------------- 运行程序，r为run简写
Starting program: /home/luo/workspace/test/exec/test1 
Breakpoint <span class="token number">1</span>, main <span class="token punctuation">(</span><span class="token punctuation">)</span> at test1.c:16
<span class="token number">16</span>		int i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n -------------- 单条语句执行，next命令简写
<span class="token number">17</span>		int j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">18</span>		int result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">19</span>		int m <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">20</span>		int *p <span class="token operator">=</span> <span class="token operator">&amp;</span>m<span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> c -------------- 继续运行程序，continue命令简写
Continuing.
result<span class="token punctuation">[</span><span class="token number">1</span>-100<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">6</span> -------------- 程序输出

Breakpoint <span class="token number">2</span>, func <span class="token punctuation">(</span>n<span class="token operator">=</span><span class="token number">250</span><span class="token punctuation">)</span> at test1.c:5
<span class="token number">5</span>		int <span class="token assign-left variable">sum</span><span class="token operator">=</span><span class="token number">0</span>,i<span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">6</span>		for<span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>n<span class="token punctuation">;</span> i++<span class="token punctuation">)</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">8</span>			<span class="token assign-left variable">sum</span><span class="token operator">+=</span>i<span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p i -------------- 打印变量i的值，p为print命令简写
<span class="token variable">$1</span> <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">6</span>		for<span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>n<span class="token punctuation">;</span> i++<span class="token punctuation">)</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">8</span>			<span class="token assign-left variable">sum</span><span class="token operator">+=</span>i<span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p <span class="token function">sum</span>
<span class="token variable">$2</span> <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">6</span>		for<span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>n<span class="token punctuation">;</span> i++<span class="token punctuation">)</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p i
<span class="token variable">$3</span> <span class="token operator">=</span> <span class="token number">1</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">8</span>			<span class="token assign-left variable">sum</span><span class="token operator">+=</span>i<span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">6</span>		for<span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>n<span class="token punctuation">;</span> i++<span class="token punctuation">)</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p <span class="token function">sum</span>
<span class="token variable">$4</span> <span class="token operator">=</span> <span class="token number">3</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> bt -------------- 查看函数堆栈
<span class="token comment">#0  func (n=250) at test1.c:6</span>
<span class="token comment">#1  0x00000000004005dd in main () at test1.c:32</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> finish -------------- 退出函数
Run till <span class="token builtin class-name">exit</span> from <span class="token comment">#0  func (n=250) at test1.c:6</span>
0x00000000004005dd <span class="token keyword">in</span> main <span class="token punctuation">(</span><span class="token punctuation">)</span> at test1.c:32
<span class="token number">32</span>		printf<span class="token punctuation">(</span><span class="token string">&quot;result[1-250] = %d <span class="token entity" title="\n">\n</span>&quot;</span>, func<span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
Value returned is <span class="token variable">$5</span> <span class="token operator">=</span> <span class="token number">31125</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> c -------------- 继续运行
Continuing.
result<span class="token punctuation">[</span><span class="token number">1</span>-250<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">31125</span> -------------- 程序输出
<span class="token punctuation">[</span>Inferior <span class="token number">1</span> <span class="token punctuation">(</span>process <span class="token number">46602</span><span class="token punctuation">)</span> exited normally<span class="token punctuation">]</span> ------------ 程序退出，调试结束
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> q -------------- 退出GDB
root@luo:~/workspace/test/exec<span class="token punctuation">\</span><span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br></div></div><h2 id="_0-3-使用gdb"><a href="#_0-3-使用gdb" class="header-anchor">#</a> 0.3 使用GDB</h2> <p>一般来说GDB主要调试的是C/C++的程序。要调试C/C++的程序，首先在编译时，我们必须要把调试信息加到可执行文件中。使用编译器（cc/gcc/g++）的 -g 参数可以做到这一点。如：</p> <p>&gt; cc -g hello.c -o hello</p> <p>&gt; g++ -g hello.cpp -o hello</p> <p>如果没有-g，你将看不见程序的函数名、变量名，所代替的全是运行时的内存地址。当你用-g把调试信息加入之后，并成功编译目标代码以后，让我们来看看如何用gdb来调试他。</p> <h3 id="_0-3-1-启动gdb"><a href="#_0-3-1-启动gdb" class="header-anchor">#</a> 0.3.1 启动GDB</h3> <p>启动GDB的方法有以下几种：</p> <p>1、gdb &lt;program&gt;</p> <p>program也就是你的执行文件，一般在当然目录下。</p> <p>2、gdb &lt;program&gt; core</p> <p>用gdb同时调试一个运行程序和core文件，core是程序非法执行后core dump后产生的文件。</p> <p>3、gdb &lt;program&gt; &lt;PID&gt;</p> <p>如果你的程序是一个服务程序，那么你可以指定这个服务程序运行时的进程ID。gdb会自动attach上去，并调试他。program应该在PATH环境变量中搜索得到。</p> <p>GDB启动时，可以加上一些GDB的启动开关，详细的开关可以用gdb -help查看。下面只例举一些比较常用的参数：</p> <p>-symbols &lt;file&gt;</p> <p>-s &lt;file&gt;</p> <p>从指定文件中读取符号表。</p> <p>-se file</p> <p>指定文件中读取符号表信息，并把他用在可执行文件中。</p> <p>-core &lt;file&gt;</p> <p>-c &lt;file&gt;</p> <p>调试时core dump的core文件。</p> <p>-directory &lt;directory&gt;</p> <p>-d &lt;directory&gt;</p> <p>加入一个源文件的搜索路径。默认搜索路径是环境变量中PATH所定义的路径。</p> <h3 id="_0-3-2-gdb环境中使用shell命令"><a href="#_0-3-2-gdb环境中使用shell命令" class="header-anchor">#</a> 0.3.2 GDB环境中使用shell命令</h3> <p>在gdb环境中，你可以执行UNIX的shell的命令，使用gdb的shell命令来完成：</p> <p><strong>shell &lt;command string&gt;</strong></p> <p>调用UNIX的shell来执行&lt;command string&gt;，环境变量SHELL中定义的UNIX的shell将会被用来执行&lt;command string&gt;，如果SHELL没有定义，那就使用UNIX的标准shell：/bin/sh。（在Windows中使用Command.com或cmd.exe）</p> <p>还有一个gdb命令是make：</p> <p><strong>make &lt;make-args&gt;</strong></p> <p>可以在gdb中执行make命令来重新build自己的程序。这个命令等价于“shell make &lt;make-args&gt;”。</p> <h3 id="_0-3-3-在gdb中运行程序"><a href="#_0-3-3-在gdb中运行程序" class="header-anchor">#</a> 0.3.3 在GDB中运行程序</h3> <p>当以gdb &lt;program&gt;方式启动gdb后，gdb会在PATH路径和当前目录中搜索&lt;program&gt;的源文件。如要确认gdb是否读到源文件，可使用l或list命令，看看gdb是否能列出源代码。</p> <p>在gdb中，运行程序使用r或是run命令。程序的运行，你有可能需要设置下面四方面的事。</p> <p>1、程序运行参数。</p> <p>set args 可指定运行时参数。（如：set args 10 20 30 40 50）</p> <p>show args 命令可以查看设置好的运行参数。</p> <p>2、运行环境。</p> <p>path &lt;dir&gt; 可设定程序的运行路径。</p> <p>show paths 查看程序的运行路径。</p> <p>set environment varname [=value] 设置环境变量。如：set env USER=aaa</p> <p>show environment [varname] 查看环境变量。</p> <p>3、工作目录。</p> <p>cd &lt;dir&gt; 相当于shell的cd命令。</p> <p>pwd 显示当前的所在目录。</p> <p>4、程序的输入输出。</p> <p>info terminal 显示你程序用到的终端的模式。</p> <p>使用重定向控制程序输出。如：run &gt; outfile</p> <p>tty命令可以指写输入输出的终端设备。如：tty /dev/ttyb。</p> <h1 id="_1-设置断点"><a href="#_1-设置断点" class="header-anchor">#</a> 1 设置断点</h1> <h2 id="_1-1-使用命令"><a href="#_1-1-使用命令" class="header-anchor">#</a> 1.1 使用命令</h2> <p><strong>break linenum</strong></p> <p>在指定行号设置断点。</p> <p><strong>break function</strong></p> <p>在函数function的入口处设置断点。C++中可以使用class::function或function(type,type)格式来指定函数名。</p> <p><strong>break +offset/-offset</strong></p> <p>在当前行前面或后面offset行设置断点，offset为自然数。</p> <p><strong>break filename:linenum</strong></p> <p>在源文件filename的linenum行处设置断点。</p> <p><strong>break filename:function</strong></p> <p>在源文件filename的function函数的入口处设置断点。</p> <p><strong>break</strong></p> <p>break命令没有参数时，表示在下一条指令处设置断点。</p> <p><strong>break args if cond</strong></p> <p>设置一个带有条件cond的断点，只有条件为“真”时才停止。args代表上述参数之一。</p> <p><strong>delete [breakpoint num]</strong></p> <p>删除断点，breakpoint num为断点号。</p> <p><strong>tbreak args</strong></p> <p>设置仅停止一次的断点。args与上面break命令的相同。程序在该断点停止后，该断点便立即被删除。</p> <h2 id="_1-2-示例"><a href="#_1-2-示例" class="header-anchor">#</a> 1.2 示例</h2> <p>源代码test1.c 同上</p> <h3 id="_1-2-1-调试过程"><a href="#_1-2-1-调试过程" class="header-anchor">#</a> 1.2.1 调试过程</h3> <p>编译生成可执行文件，注意要带上 <em>-g</em> ：</p> <p><em>root@luo:~/workspace/test/source\&gt;gcc -g test.c -o ../exec/test</em></p> <p>使用GDB调试：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>
root@luo:~/workspace/test/source<span class="token punctuation">\</span><span class="token operator">&gt;</span>gcc -g test.c -o <span class="token punctuation">..</span>/exec/test
使用GDB调试：
root@luo:~/workspace/test/exec<span class="token punctuation">\</span><span class="token operator">&gt;</span>gdb <span class="token builtin class-name">test</span> 
GNU gdb <span class="token punctuation">(</span>Wind River Linux Sourcery CodeBench <span class="token number">4.8</span>-45<span class="token punctuation">)</span> <span class="token number">7.6</span>
Copyright <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token number">2013</span> Free Software Foundation, Inc.
License GPLv3+: GNU GPL version <span class="token number">3</span> or later <span class="token operator">&lt;</span>http://gnu.org/licenses/gpl.html<span class="token operator">&gt;</span>
This is <span class="token function">free</span> software: you are <span class="token function">free</span> to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type <span class="token string">&quot;show copying&quot;</span>
and <span class="token string">&quot;show warranty&quot;</span> <span class="token keyword">for</span> details.
This GDB was configured as <span class="token string">&quot;x86_64-wrs-linux-gnu&quot;</span><span class="token builtin class-name">.</span>
For bug reporting instructions, please see:
<span class="token operator">&lt;</span>support@windriver.com<span class="token operator">&gt;</span><span class="token punctuation">..</span>.
Reading symbols from /home/luo/workspace/test/exec/test<span class="token punctuation">..</span>.done.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> l <span class="token number">1</span> -------------- l为list的简写，从第一行开始列出源码
<span class="token number">1</span>	<span class="token comment">#include &lt;stdio.h&gt;</span>
<span class="token number">2</span>	
<span class="token number">3</span>	int func<span class="token punctuation">(</span>int n<span class="token punctuation">)</span>
<span class="token number">4</span>	<span class="token punctuation">{</span>
<span class="token number">5</span>		int <span class="token assign-left variable">sum</span><span class="token operator">=</span><span class="token number">0</span>,i<span class="token punctuation">;</span>
<span class="token number">6</span>		for<span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>n<span class="token punctuation">;</span> i++<span class="token punctuation">)</span>
<span class="token number">7</span>		<span class="token punctuation">{</span>
<span class="token number">8</span>			<span class="token assign-left variable">sum</span><span class="token operator">+=</span>i<span class="token punctuation">;</span>
<span class="token number">9</span>		<span class="token punctuation">}</span>
<span class="token number">10</span>		<span class="token builtin class-name">return</span> <span class="token function">sum</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> -------------- 直接回车，表示重复上一次命令
<span class="token number">11</span>	<span class="token punctuation">}</span>
<span class="token number">12</span>	
<span class="token number">13</span>	
<span class="token number">14</span>	int main<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token number">15</span>	<span class="token punctuation">{</span>
<span class="token number">16</span>		int i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token number">17</span>		int j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token number">18</span>		int result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token number">19</span>		int m <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token number">20</span>		int *p <span class="token operator">=</span> <span class="token operator">&amp;</span>m<span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> 
<span class="token number">21</span>		for<span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">&lt;=</span><span class="token number">3</span><span class="token punctuation">;</span> i++<span class="token punctuation">)</span>
<span class="token number">22</span>		<span class="token punctuation">{</span>
<span class="token number">23</span>			result <span class="token operator">+=</span> i<span class="token punctuation">;</span>
<span class="token number">24</span>	    
<span class="token number">25</span>			for<span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">;</span> j++<span class="token punctuation">)</span>
<span class="token number">26</span>			<span class="token punctuation">{</span>
<span class="token number">27</span>				m++<span class="token punctuation">;</span>
<span class="token number">28</span>			<span class="token punctuation">}</span>
<span class="token number">29</span>		<span class="token punctuation">}</span>
<span class="token number">30</span>	
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> 
<span class="token number">31</span>		printf<span class="token punctuation">(</span><span class="token string">&quot;result[1-100] = %d <span class="token entity" title="\n">\n</span>&quot;</span>, result <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token number">32</span>		printf<span class="token punctuation">(</span><span class="token string">&quot;result[1-250] = %d <span class="token entity" title="\n">\n</span>&quot;</span>, func<span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token number">33</span>	
<span class="token number">34</span>		<span class="token builtin class-name">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token number">35</span>	<span class="token punctuation">}</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token builtin class-name">break</span> main -------------- 设置断点，在函数main<span class="token punctuation">(</span><span class="token punctuation">)</span>入口处。
Breakpoint <span class="token number">1</span> at 0x400566: <span class="token function">file</span> test.c, line <span class="token number">17</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token builtin class-name">break</span> <span class="token number">21</span> -------------- 设置断点，在源程序第21行
Breakpoint <span class="token number">2</span> at 0x400585: <span class="token function">file</span> test.c, line <span class="token number">21</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token builtin class-name">break</span> test.c:func  -------------- 设置断点，在test.c文件的func<span class="token punctuation">(</span><span class="token punctuation">)</span>函数入口处
Breakpoint <span class="token number">3</span> at 0x400537: <span class="token function">file</span> test.c, line <span class="token number">5</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> r -------------- 运行程序，run命令简写
Starting program: /home/luo/workspace/test/exec/test 

Breakpoint <span class="token number">1</span>, main <span class="token punctuation">(</span><span class="token punctuation">)</span> at test.c:17 ---------- 程序在main<span class="token punctuation">(</span><span class="token punctuation">)</span>入口停止
<span class="token number">17</span>		int j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> c -------------- 继续运行程序，continue命令的简写
Continuing.

Breakpoint <span class="token number">2</span>, main <span class="token punctuation">(</span><span class="token punctuation">)</span> at test.c:22 -------------- 程序在22行停止
<span class="token number">22</span>		<span class="token punctuation">{</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> tbreak <span class="token number">26</span>  -------------- 设置临时断点，在26行
Temporary breakpoint <span class="token number">4</span> at 0x400594: <span class="token function">file</span> test.c, line <span class="token number">26</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> info b -------------- 查看断点信息
Num     Type           Disp Enb Address            What
<span class="token number">1</span>       breakpoint     keep y   0x0000000000400566 <span class="token keyword">in</span> main at test.c:17
	breakpoint already hit <span class="token number">1</span> <span class="token function">time</span>
<span class="token number">2</span>       breakpoint     keep y   0x0000000000400585 <span class="token keyword">in</span> main at test.c:21
	breakpoint already hit <span class="token number">1</span> <span class="token function">time</span>
<span class="token number">3</span>       breakpoint     keep y   0x0000000000400537 <span class="token keyword">in</span> func at test.c:5
<span class="token number">4</span>       breakpoint     del  y   0x0000000000400594 <span class="token keyword">in</span> main at test.c:26
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> c -------------- 继续运行程序
Continuing.

Temporary breakpoint <span class="token number">4</span>, main <span class="token punctuation">(</span><span class="token punctuation">)</span> at test.c:26  --------------程序在26行停止
<span class="token number">26</span>			<span class="token punctuation">{</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> info b -------------- 再查看断点信息，临时断点已删除
Num     Type           Disp Enb Address            What
<span class="token number">1</span>       breakpoint     keep y   0x0000000000400566 <span class="token keyword">in</span> main at test.c:17
	breakpoint already hit <span class="token number">1</span> <span class="token function">time</span>
<span class="token number">2</span>       breakpoint     keep y   0x0000000000400585 <span class="token keyword">in</span> main at test.c:21
	breakpoint already hit <span class="token number">1</span> <span class="token function">time</span>
<span class="token number">3</span>       breakpoint     keep y   0x0000000000400537 <span class="token keyword">in</span> func at test.c:5
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token builtin class-name">break</span> <span class="token number">27</span> <span class="token keyword">if</span> m <span class="token operator">=</span> <span class="token number">10</span> ------------ 设置断点，在27行，当m<span class="token operator">=</span><span class="token number">10</span>时生效
Breakpoint <span class="token number">5</span> at 0x4005b1: <span class="token function">file</span> test.c, line <span class="token number">27</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> c -------------- 继续运行程序
Continuing.

Breakpoint <span class="token number">2</span>, main <span class="token punctuation">(</span><span class="token punctuation">)</span> at test.c:22 ------------ 程序在22行停止
<span class="token number">22</span>		<span class="token punctuation">{</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> c -------------- 继续运行程序
Continuing.

Breakpoint <span class="token number">2</span>, main <span class="token punctuation">(</span><span class="token punctuation">)</span> at test.c:22
<span class="token number">22</span>		<span class="token punctuation">{</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> c -------------- 继续运行程序
Continuing.

Breakpoint <span class="token number">5</span>, main <span class="token punctuation">(</span><span class="token punctuation">)</span> at test.c:30 -------------- 程序在30行停止
<span class="token number">30</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> print <span class="token string">&quot;%d&quot;</span>, m -------------- 打印m的值
<span class="token variable">$1</span> <span class="token operator">=</span> <span class="token number">10</span> -------------- 此时m <span class="token operator">=</span> <span class="token number">10</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> c -------------- 继续运行程序
Continuing.
result<span class="token punctuation">[</span><span class="token number">1</span>-100<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">6</span> 

Breakpoint <span class="token number">3</span>, func <span class="token punctuation">(</span>n<span class="token operator">=</span><span class="token number">250</span><span class="token punctuation">)</span> at test.c:5 ---------- 程序在func<span class="token punctuation">(</span><span class="token punctuation">)</span>函数入口处停止
<span class="token number">5</span>		int <span class="token assign-left variable">sum</span><span class="token operator">=</span><span class="token number">0</span>,i<span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> tbreak +3 -------------- 在当前行+3行处设置临时断点
Temporary breakpoint <span class="token number">8</span> at 0x400547: <span class="token function">file</span> test.c, line <span class="token number">8</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> c -------------- 继续运行程序
Continuing.
Temporary breakpoint <span class="token number">8</span>, func <span class="token punctuation">(</span>n<span class="token operator">=</span><span class="token number">250</span><span class="token punctuation">)</span> at test.c:8
<span class="token number">8</span>			<span class="token assign-left variable">sum</span><span class="token operator">+=</span>i<span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token builtin class-name">break</span> -------------- 在下一条指令处设置断点
Breakpoint <span class="token number">9</span> at 0x400547: <span class="token function">file</span> test.c, line <span class="token number">8</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> c -------------- 继续运行程序
Continuing.
Breakpoint <span class="token number">9</span>, func <span class="token punctuation">(</span>n<span class="token operator">=</span><span class="token number">250</span><span class="token punctuation">)</span> at test.c:8 -------------- 在第8行停止
<span class="token number">8</span>			<span class="token assign-left variable">sum</span><span class="token operator">+=</span>i<span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> c -------------- 继续运行程序
Continuing.
Breakpoint <span class="token number">9</span>, func <span class="token punctuation">(</span>n<span class="token operator">=</span><span class="token number">250</span><span class="token punctuation">)</span> at test.c:8 -------------- 在第8行停止
<span class="token number">8</span>			<span class="token assign-left variable">sum</span><span class="token operator">+=</span>i<span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token function">clear</span> --------------清楚所有断点
Deleted breakpoint <span class="token number">9</span> 
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> c -------------- 继续运行程序
Continuing.
result<span class="token punctuation">[</span><span class="token number">1</span>-250<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">31125</span> 
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br></div></div><h1 id="_2-程序的单步执行"><a href="#_2-程序的单步执行" class="header-anchor">#</a> 2 程序的单步执行</h1> <h2 id="_2-1-使用命令"><a href="#_2-1-使用命令" class="header-anchor">#</a> 2.1 使用命令</h2> <p><strong>step &lt;count&gt;</strong></p> <p>单步跟踪，如果有函数调用，他会进入该函数。进入函数的前提是，此函数被编译有debug信息。后面可以加count也可以不加，不加表示一条条地执行，加表示执行后面的count条指令，然后再停住。</p> <p><strong>next &lt;count&gt;</strong></p> <p>同样单步跟踪，如果有函数调用，他不会进入该函数。后面可以加count也可以不加，不加表示一条条地执行，加表示执行后面的count条指令，然后再停住。</p> <p><strong>finish</strong></p> <p>运行程序，直到当前函数完成返回。并打印函数返回时的堆栈地址和返回值及参数值等信息。</p> <p><strong>until 或 u</strong></p> <p>当你厌倦了在一个循环体内单步跟踪时，这个命令可以运行程序直到退出循环体。</p> <h2 id="_2-2-示例"><a href="#_2-2-示例" class="header-anchor">#</a> 2.2 示例</h2> <p>源代码test1.c 同上</p> <h3 id="_2-2-1-调试过程"><a href="#_2-2-1-调试过程" class="header-anchor">#</a> 2.2.1 调试过程</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>root@luo:~/workspace/test/exec<span class="token punctuation">\</span><span class="token operator">&gt;</span>gdb -q <span class="token builtin class-name">test</span> 
----- 启动GDB，-q使启动使版本信息不显示
Reading symbols from /home/luo/workspace/test/exec/test<span class="token punctuation">..</span>.done.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token builtin class-name">break</span> <span class="token number">18</span> -------------- 在第18行设置断点
Breakpoint <span class="token number">1</span> at 0x400574: <span class="token function">file</span> test.c, line <span class="token number">18</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> r -------------- 运行程序
Starting program: /home/luo/workspace/test/exec/test 

Breakpoint <span class="token number">1</span>, main <span class="token punctuation">(</span><span class="token punctuation">)</span> at test.c:18 -------------- 在18行停止
<span class="token number">18</span>		int result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n -------------- 下一条
<span class="token number">19</span>		int m <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n -------------- 下一条
<span class="token number">20</span>		int *p <span class="token operator">=</span> <span class="token operator">&amp;</span>m<span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> s -------------- 下一条
<span class="token number">21</span>		for<span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">&lt;=</span><span class="token number">3</span><span class="token punctuation">;</span> i++<span class="token punctuation">)</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> s -------------- 下一条
<span class="token number">23</span>			result <span class="token operator">+=</span> i<span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n -------------- 下一条
<span class="token number">25</span>			for<span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">;</span> j++<span class="token punctuation">)</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n -------------- 下一条 
<span class="token number">27</span>				m++<span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> u -------------- 运行函数到退出当前循环
<span class="token number">25</span>			for<span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">;</span> j++<span class="token punctuation">)</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> u -------------- 运行程序到退出当前循环
<span class="token number">21</span>		for<span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">&lt;=</span><span class="token number">3</span><span class="token punctuation">;</span> i++<span class="token punctuation">)</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> u -------------- 运行程序到退出当前循环
<span class="token number">31</span>		printf<span class="token punctuation">(</span><span class="token string">&quot;result[1-100] = %d <span class="token entity" title="\n">\n</span>&quot;</span>, result <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> s -------------- 下一条
result<span class="token punctuation">[</span><span class="token number">1</span>-100<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">6</span> 
<span class="token number">32</span>		printf<span class="token punctuation">(</span><span class="token string">&quot;result[1-250] = %d <span class="token entity" title="\n">\n</span>&quot;</span>, func<span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> s -------------- step下一条
func <span class="token punctuation">(</span>n<span class="token operator">=</span><span class="token number">250</span><span class="token punctuation">)</span> at test.c:5 -------------- 进入函数func<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token number">5</span>		int <span class="token assign-left variable">sum</span><span class="token operator">=</span><span class="token number">0</span>,i<span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> finish -------------- 运行程序到函数完成
Run till <span class="token builtin class-name">exit</span> from <span class="token comment">#0  func (n=250) at test.c:5</span>
0x00000000004005dd <span class="token keyword">in</span> main <span class="token punctuation">(</span><span class="token punctuation">)</span> at test.c:32
<span class="token number">32</span>		printf<span class="token punctuation">(</span><span class="token string">&quot;result[1-250] = %d <span class="token entity" title="\n">\n</span>&quot;</span>, func<span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
Value returned is <span class="token variable">$1</span> <span class="token operator">=</span> <span class="token number">31125</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> r -------------- 再次运行程序
The program being debugged has been started already.
Start it from the beginning? <span class="token punctuation">(</span>y or n<span class="token punctuation">)</span> y
Starting program: /home/luo/workspace/test/exec/test 
Breakpoint <span class="token number">1</span>, main <span class="token punctuation">(</span><span class="token punctuation">)</span> at test.c:18 -------------- 程序在18行停止
<span class="token number">18</span>		int result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token builtin class-name">break</span> <span class="token number">30</span> -------------- 设置断点，在30行
Breakpoint <span class="token number">2</span> at 0x4005bf: <span class="token function">file</span> test.c, line <span class="token number">30</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> c -------------- 继续运行程序
Continuing.
Breakpoint <span class="token number">2</span>, main <span class="token punctuation">(</span><span class="token punctuation">)</span> at test.c:31 -------------- 程序在31行停止
<span class="token number">31</span>		printf<span class="token punctuation">(</span><span class="token string">&quot;result[1-100] = %d <span class="token entity" title="\n">\n</span>&quot;</span>, result <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n -------------- next下一条
result<span class="token punctuation">[</span><span class="token number">1</span>-100<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">6</span> 
<span class="token number">32</span>		printf<span class="token punctuation">(</span><span class="token string">&quot;result[1-250] = %d <span class="token entity" title="\n">\n</span>&quot;</span>, func<span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n -------------- next下一条
result<span class="token punctuation">[</span><span class="token number">1</span>-250<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">31125</span>  -------------- 未进入函数func<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token number">34</span>		<span class="token builtin class-name">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br></div></div><h1 id="_3-显示-修改变量的值"><a href="#_3-显示-修改变量的值" class="header-anchor">#</a> 3 显示/修改变量的值</h1> <h2 id="_3-1使用命令"><a href="#_3-1使用命令" class="header-anchor">#</a> 3.1使用命令</h2> <p><strong>print &lt;expr&gt;</strong></p> <p><strong>print /&lt;f&gt; &lt;expr&gt;</strong></p> <p>当程序被停住时，可以使用print命令（简写为p），或同义命令inspect来查看当前程序的运行数据。&lt;expr&gt;是表达式，是你所调试的程序的语言的表达式（GDB可以调试多种编程语言），&lt;f&gt;是输出的格式，比如，如果要把表达式按16进制的格式输出，那么就是/x。</p> <p><strong>注意</strong>：GDB中，变量分为全局变量、静态全局变量、局部变量三种，当局部变量与全局变量发生重名时，用pirnt显示出的变量的值会是函数中的局部变量的值。此时如果要查看全局变量的值，可以使用“::”操作符：</p> <p><strong>file::variable</strong></p> <p><strong>function::variable</strong></p> <p>可以通过这种形式查看某个文件或是某个函数的变量。</p> <h2 id="_3-2示例"><a href="#_3-2示例" class="header-anchor">#</a> 3.2示例</h2> <h3 id="_3-2-1-源代码test2-c"><a href="#_3-2-1-源代码test2-c" class="header-anchor">#</a> 3.2.1 源代码test2.c</h3> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token number">1.</span>#include <span class="token operator">&lt;</span>stdio<span class="token punctuation">.</span>h<span class="token operator">&gt;</span>  
<span class="token number">2.</span>  
<span class="token number">3.</span><span class="token keyword">int</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> m<span class="token punctuation">)</span><span class="token punctuation">{</span>   
<span class="token number">4.</span>    <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  
<span class="token number">5.</span>    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  
<span class="token number">6.</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
<span class="token number">7.</span>        n <span class="token operator">+=</span> m<span class="token punctuation">;</span>  
<span class="token number">8.</span>    <span class="token punctuation">}</span>     
<span class="token number">9.</span>  
<span class="token number">10.</span>    <span class="token keyword">return</span> n<span class="token punctuation">;</span>  
<span class="token number">11.</span>
<span class="token number">12.</span><span class="token punctuation">}</span>  
<span class="token number">13.</span>  
<span class="token number">14.</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
<span class="token number">15.</span>    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  
<span class="token number">16.</span>    <span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  
<span class="token number">17.</span>    <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>   
<span class="token number">18.</span>    <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  
<span class="token number">19.</span>    sum <span class="token operator">=</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token number">20.</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
<span class="token number">21.</span>        n<span class="token operator">++</span><span class="token punctuation">;</span>  
<span class="token number">22.</span>    <span class="token punctuation">}</span>     
<span class="token number">23.</span>  
<span class="token number">24.</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h3 id="_3-2-2-调试过程"><a href="#_3-2-2-调试过程" class="header-anchor">#</a> 3.2.2 调试过程</h3> <p>编译生成可执行文件：</p> <p><em>root@luo:~/workspace/test/source\&gt;gcc -g test2.c -o ../exec/test2</em></p> <p>启动GDB：</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>
root@luo:~/workspace/test/source<span class="token punctuation">\</span><span class="token operator">&gt;</span>gcc -g test2.c -o <span class="token punctuation">..</span>/exec/test2
启动GDB：
root@luo:~/workspace/test/exec<span class="token punctuation">\</span><span class="token operator">&gt;</span>gdb -q test2
Reading symbols from /home/luo/workspace/test/exec/test2<span class="token punctuation">..</span>.done.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> l <span class="token number">1</span>
<span class="token number">1</span>	<span class="token comment">#include &lt;stdio.h&gt;</span>
<span class="token number">2</span>	
<span class="token number">3</span>	int func<span class="token punctuation">(</span>int m<span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token number">4</span>		int n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token number">5</span>		int i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token number">6</span>		for<span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> i++<span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token number">7</span>			n <span class="token operator">+=</span> m<span class="token punctuation">;</span>
<span class="token number">8</span>		<span class="token punctuation">}</span>
<span class="token number">9</span>	
<span class="token number">10</span>		<span class="token builtin class-name">return</span> n<span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> 
<span class="token number">11</span>	
<span class="token number">12</span>	<span class="token punctuation">}</span>
<span class="token number">13</span>	
<span class="token number">14</span>	int <span class="token function-name function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token number">15</span>		int i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token number">16</span>		int b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token number">17</span>		int n <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
<span class="token number">18</span>		int <span class="token function">sum</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token number">19</span>		<span class="token function">sum</span> <span class="token operator">=</span> func<span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token number">20</span>		for<span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i++<span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> 
<span class="token number">21</span>			n++<span class="token punctuation">;</span>
<span class="token number">22</span>		<span class="token punctuation">}</span>
<span class="token number">23</span>	
<span class="token number">24</span>		<span class="token builtin class-name">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token number">25</span>	<span class="token punctuation">}</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token builtin class-name">break</span> func -------------- 设置断点，在func<span class="token punctuation">(</span><span class="token punctuation">)</span>函数入口处
Breakpoint <span class="token number">1</span> at 0x4004f7: <span class="token function">file</span> test2.c, line <span class="token number">4</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token builtin class-name">break</span> <span class="token number">21</span> -------------- 设置断点，在21行
Breakpoint <span class="token number">2</span> at 0x40055f: <span class="token function">file</span> test2.c, line <span class="token number">21</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> r -------------- 运行程序
Starting program: /home/luo/workspace/test/exec/test2 

Breakpoint <span class="token number">1</span>, func <span class="token punctuation">(</span>m<span class="token operator">=</span><span class="token number">40</span><span class="token punctuation">)</span> at test2.c:4
<span class="token number">4</span>		int n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p n -------------- 在func<span class="token punctuation">(</span><span class="token punctuation">)</span>函数内，显示变量n的值
<span class="token variable">$1</span> <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p main::n ------------ 在func<span class="token punctuation">(</span><span class="token punctuation">)</span>内，显示main<span class="token punctuation">(</span><span class="token punctuation">)</span>函数中n的值
<span class="token variable">$2</span> <span class="token operator">=</span> <span class="token number">20</span> 
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> c -------------- 继续运行程序
Continuing.

Breakpoint <span class="token number">2</span>, main <span class="token punctuation">(</span><span class="token punctuation">)</span> at test2.c:21
<span class="token number">21</span>			n++<span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p n -------------- 显示n的值
<span class="token variable">$3</span> <span class="token operator">=</span> <span class="token number">20</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p n <span class="token operator">=</span> <span class="token number">50</span> -------------- 修改n的值为50
<span class="token variable">$4</span> <span class="token operator">=</span> <span class="token number">50</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p n -------------- 显示n的值
<span class="token variable">$5</span> <span class="token operator">=</span> <span class="token number">50</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> c -------------- 继续运行程序
Continuing.

Breakpoint <span class="token number">2</span>, main <span class="token punctuation">(</span><span class="token punctuation">)</span> at test2.c:21
<span class="token number">21</span>			n++<span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p n ------------ 显示n的值，可以看到，n在修改基础上加1
<span class="token variable">$6</span> <span class="token operator">=</span> <span class="token number">51</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p /x n ------------ 用16进制显示n值
<span class="token variable">$7</span> <span class="token operator">=</span> 0x33 
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br></div></div><h1 id="_4-监视程序变量值"><a href="#_4-监视程序变量值" class="header-anchor">#</a> 4 监视程序变量值</h1> <h2 id="_4-1-使用命令"><a href="#_4-1-使用命令" class="header-anchor">#</a> 4.1 使用命令</h2> <p><strong>display &lt;expr&gt;</strong></p> <p><strong>display/&lt;fmt&gt; &lt;expr&gt;</strong></p> <p><strong>display/&lt;fmt&gt; &lt;addr&gt;</strong></p> <p>display命令可以设置一些自动显示的变量，当程序停住时，或是在单步跟踪时，这些变量会自动显示。expr是一个表达式，fmt表示显示的格式，addr表示内存地址，当用display设定好了一个或多个表达式后，只要程序被停下来，GDB会自动显示你所设置的这些表达式的值。</p> <p><strong>undisplay &lt;dnums...&gt;</strong></p> <p><strong>delete display &lt;dnums...&gt;</strong></p> <p>删除自动显示，dnums意为所设置好了的自动显式的编号。如果要同时删除几个，编号可以用空格分隔，如果要删除一个范围内的编号，可以用减号表示（如：2-5）。</p> <p><strong>disable display &lt;dnums...&gt;</strong></p> <p><strong>enable display &lt;dnums...&gt;</strong></p> <p>disable和enalbe不删除自动显示的设置，而只是让其失效和恢复。</p> <p><strong>info display</strong></p> <p>查看display设置的自动显示的信息，包括设置的编号，表达式，是否enable。</p> <h2 id="_4-2-示例"><a href="#_4-2-示例" class="header-anchor">#</a> 4.2 示例</h2> <p>源代码test2.c同上</p> <h3 id="_4-2-1-调试过程"><a href="#_4-2-1-调试过程" class="header-anchor">#</a> 4.2.1 调试过程</h3> <p>启动GDB：</p> <p><em>root@luo:~/workspace/test/exec\&gt;gdb -q test2</em></p> <p><em>Reading symbols from /home/luo/workspace/test/exec/test2...done.</em></p> <p><em>(gdb) l 1 --------------</em> 列出源代码</p> <p><em>1 #include &lt;stdio.h&gt;</em></p> <p><em>2</em></p> <p><em>3 int func(int m){</em></p> <p><em>4  int n = 0;</em></p> <p><em>5  int i = 0;</em></p> <p><em>6  for(i = 0; i &lt; m; i++){</em></p> <p><em>7   n += m;</em></p> <p><em>8  }</em></p> <p><em>9</em></p> <p><em>10  return n;</em></p> <p><em>(gdb)</em></p> <p><em>11</em></p> <p><em>12 }</em></p> <p><em>13</em></p> <p><em>14 int main(){</em></p> <p><em>15  int i = 0;</em></p> <p><em>16  int b = 0;</em></p> <p><em>17  int n = 20;</em></p> <p><em>18  int sum = 0;</em></p> <p><em>19  sum = func(40);</em></p> <p><em>20  for(i = 0; i &lt; 10; i++){</em></p> <p><em>(gdb)</em></p> <p><em>21   n++;</em></p> <p><em>22  }</em></p> <p><em>23</em></p> <p><em>24  return 0;</em></p> <p><em>25 }</em></p> <p><em>(gdb) break 21 --------------</em> 设置断点，在21行</p> <p><em>Breakpoint 1 at 0x40055f: file test2.c, line 21.</em></p> <p><em>(gdb) r --------------</em> 运行程序</p> <p><em>Starting program: /home/luo/workspace/test/exec/test2</em></p> <p><em>Breakpoint 1, main () at test2.c:21</em></p> <p><em>21   n++;</em></p> <p><em>(gdb) display n --------------</em> 跟踪变量<em>n</em>的值</p> <p><em>1: n = 20</em></p> <p><em>(gdb) display i --------------</em> 跟踪变量<em>i</em>的值</p> <p><em>2: i = 0</em></p> <p><em>(gdb) display n+i --------------</em> 跟踪<em>n+i</em>的值</p> <p><em>3: n+i = 20</em></p> <p><em>(gdb) display/x n --------------</em> 跟踪<em>n</em>的值，以16进制显示</p> <p><em>4: /x n = 0x14</em></p> <p><em>(gdb) display &amp;n --------------</em> 跟踪<em>n</em>的地址</p> <p><em>5: &amp;n = (int *) 0x7fffffffe0a8</em></p> <p><em>(gdb) c --------------</em> 继续运行程序</p> <p><em>Continuing.</em></p> <p><em>Breakpoint 1, main () at test2.c:21</em></p> <p><em>21   n++;</em></p> <p><em>5: &amp;n = (int *) 0x7fffffffe0a8</em></p> <p><em>4: /x n = 0x15</em></p> <p><em>3: n+i = 22</em></p> <p><em>2: i = 1</em></p> <p><em>1: n = 21</em></p> <p><em>(gdb) delete display 4 --------------</em> 删除4号跟踪</p> <p><em>(gdb) c --------------</em> 继续运行程序</p> <p><em>Continuing.</em></p> <p><em>Breakpoint 1, main () at test2.c:21 ------------</em> 可以看到，4号没了</p> <p><em>21   n++;</em></p> <p><em>5: &amp;n = (int *) 0x7fffffffe0a8</em></p> <p><em>3: n+i = 24</em></p> <p><em>2: i = 2</em></p> <p><em>1: n = 22</em></p> <p><em>(gdb) disable display 5 --------------</em> 使5号跟踪失效</p> <p><em>(gdb) c --------------</em> 继续运行程序</p> <p><em>Continuing.</em></p> <p><em>Breakpoint 1, main () at test2.c:21  -------</em> 可以看到，5号也没显示</p> <p><em>21   n++;</em></p> <p><em>3: n+i = 26</em></p> <p><em>2: i = 3</em></p> <p><em>1: n = 23</em></p> <p><em>(gdb) enable display 5 --------------</em> 使5号跟踪恢复</p> <p><em>(gdb) c --------------</em> 继续运行程序</p> <p><em>Continuing.</em></p> <p><em>Breakpoint 1, main () at test2.c:21  ------</em> 可以看到，5号再次显示</p> <p><em>21   n++;</em></p> <p><em>5: &amp;n = (int *) 0x7fffffffe0a8</em></p> <p><em>3: n+i = 28</em></p> <p><em>2: i = 4</em></p> <p><em>1: n = 24</em></p> <p><em>(gdb) info display --------------</em> 查看自动显示信息</p> <p><em>Auto-display expressions now in effect:</em></p> <p><em>Num Enb Expression</em></p> <p><em>5: y &amp;n</em></p> <p><em>3: y n+i</em></p> <p><em>2: y i</em></p> <p><em>1: y n</em></p> <p><em>(gdb) disable display 1 2 3 -----------</em> 使1，2，3号都失效</p> <p><em>(gdb) c --------------</em> 继续运行程序</p> <p><em>Continuing.</em></p> <p><em>Breakpoint 1, main () at test2.c:21</em></p> <p><em>21   n++;</em></p> <p><em>5: &amp;n = (int *) 0x7fffffffe0a8</em></p> <p><em>(gdb) info display --------------</em> 查看自动显示信息</p> <p><em>Auto-display expressions now in effect:</em></p> <p><em>Num Enb Expression</em></p> <p><em>5: y &amp;n</em></p> <p><em>3: n n+i</em></p> <p><em>2: n i</em></p> <p><em>1: n n</em></p> <p><em>(gdb)</em></p> <ul><li></li> <li></li></ul> <h1 id="_5-显示-修改寄存器"><a href="#_5-显示-修改寄存器" class="header-anchor">#</a> 5 显示/修改寄存器</h1> <h2 id="_5-1-背景知识"><a href="#_5-1-背景知识" class="header-anchor">#</a> 5.1 背景知识</h2> <p>先明确一点，这里指的是通用寄存器（后简称寄存器）。既然是通用的，使用并没有限制；后面介绍寄存器使用规则或者惯例，只是GCC/G++的规则。因为我们想对GCC编译的C/C++序进行分析，所以了解这些规则就很有帮助。</p> <p>在体系结构教科书中，寄存器通常被说成寄存器文件，其实就是CPU上的一块存储区域，不过更喜欢使用标识符来表示，而不是地址而已。</p> <p>X86-64中，所有寄存器都是64位，相对32位的x86来说，标识符发生了变化，比如：从原来的%ebp变成了%rbp。为了向后兼容性，%ebp依然可以使用，不过指向了%rbp的低32位。</p> <p>X86-64寄存器的变化，不仅体现在位数上，更加体现在寄存器数量上。新增加寄存器%r8到%r15。加上x86的原有8个，一共16个寄存器。</p> <p>刚刚说到，寄存器集成在CPU上，存取速度比存储器快好几个数量级，寄存器多了，GCC就可以更多的使用寄存器，替换之前的存储器堆栈使用，从而大大提升性能。</p> <p>让寄存器为己所用，就得了解它们的用途，这些用途都涉及函数调用，X86-64有16个64位寄存器，分别是：</p> <p>%rax，%rbx，%rcx，%rdx，%rsi，%rdi，%rbp，%rsp，%r8，%r9，%r10，%r11，%r12，%r13，%r14，%r15。</p> <p>其中：</p> <p>%rax 作为函数返回值使用。</p> <p>%rsp 栈指针寄存器，指向栈顶。</p> <p>%rdi，%rsi，%rdx，%rcx，%r8，%r9 用作函数参数，依次对应第1参数，第2参数…</p> <p>%rbx，%rbp，%r12，%r13，%14，%15 用作数据存储，遵循被调用者使用规则，简单说就是随便用，调用子函数之前要备份它，以防他被修改。</p> <p>%r10，%r11 用作数据存储，遵循调用者使用规则，简单说就是使用之前要先保存原值。</p> <p><img src="media/1e797b88a9a47d8bf638b1897e086c27.png" alt=""></p> <h2 id="_5-2-使用命令"><a href="#_5-2-使用命令" class="header-anchor">#</a> 5.2 使用命令</h2> <p><strong>info registers</strong></p> <p>查看寄存器的情况。（不包括浮点寄存器）</p> <p><strong>info all-registers</strong></p> <p>查看所有寄存器的情况。（包括浮点寄存器）</p> <p><strong>info registers &lt;regname …&gt;</strong></p> <p>查看所指定的寄存器的情况。</p> <p><strong>set $&lt;regname&gt;=&lt;value&gt;</strong></p> <p>修改寄存器的值。</p> <h2 id="_5-3-示例"><a href="#_5-3-示例" class="header-anchor">#</a> 5.3 示例</h2> <p>源代码test2.c同上</p> <h3 id="_5-2-1-调试过程"><a href="#_5-2-1-调试过程" class="header-anchor">#</a> 5.2.1 调试过程</h3> <p>启动GDB：</p> <p><em>root@luo:~/workspace/test/exec\&gt;gdb -q test2</em></p> <p><em>Reading symbols from /home/luo/workspace/test/exec/test2...done.</em></p> <p><em>(gdb) b main --------------</em> 在main函数设置断点</p> <p><em>Breakpoint 1 at 0x40052d: file test2.c, line 15.</em></p> <p><em>(gdb) r --------------</em> 运行程序</p> <p><em>Starting program: /home/luo/workspace/test/exec/test2</em></p> <p><em>Breakpoint 1, main () at test2.c:15</em></p> <p><em>15  int i = 0;</em></p> <p><em>(gdb) s --------------</em> step单步执行</p> <p><em>16  int b = 0;</em></p> <p><em>(gdb)</em></p> <p><em>17  int n = 20;</em></p> <p><em>(gdb)</em></p> <p><em>18  int sum = 0;</em></p> <p><em>(gdb)</em></p> <p><em>19  sum = func(40);</em></p> <p><em>(gdb)</em></p> <p><em>func (m=40) at test2.c:4 --------------</em> 进入*func()*函数了</p> <p><em>4  int n = 0;</em></p> <p><em>(gdb) i all-r --------------</em> 显示所有寄存器信息</p> <p><em>rax 0x400525 4195621</em></p> <p><em>rbx 0x0 0</em></p> <p><em>rcx 0x0 0</em></p> <p><em>rdx 0x7fffffffe1a8 140737488347560</em></p> <p><em>rsi 0x7fffffffe198 140737488347544</em></p> <p><em>rdi 0x28 40</em></p> <p><em>rbp 0x7fffffffe090 0x7fffffffe090</em></p> <p><em>rsp 0x7fffffffe090 0x7fffffffe090</em></p> <p><em>r8 0x30555a3c60 207590407264</em></p> <p><em>r9 0x305360ec80 207557291136</em></p> <p><em>r10 0x7fffffffdf40 140737488346944</em></p> <p><em>r11 0x3055221b00 207586728704</em></p> <p><em>r12 0x4003b0 4195248</em></p> <p><em>r13 0x7fffffffe190 140737488347536</em></p> <p><em>r14 0x0 0</em></p> <p><em>r15 0x0 0</em></p> <p><em>rip 0x4004f7 0x4004f7 &lt;func+7&gt;</em></p> <p><em>eflags 0x206 [ PF IF ]</em></p> <p><em>cs 0x33 51</em></p> <p><em>ss 0x2b 43</em></p> <p><em>ds 0x0 0</em></p> <p><em>es 0x0 0</em></p> <p><em>fs 0x0 0</em></p> <p><em>gs 0x0 0</em></p> <p><em>st0 0 (raw 0x00000000000000000000)</em></p> <p><em>st1 0 (raw 0x00000000000000000000)</em></p> <p><em>---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---q</em></p> <p><em>Quit --------------</em> 退出显示</p> <p><em>(gdb) i r --------------</em> 显示寄存器信息，不包括浮点寄存器</p> <p><em>rax 0x400525 4195621</em></p> <p><em>rbx 0x0 0</em></p> <p><em>rcx 0x0 0</em></p> <p><em>rdx 0x7fffffffe1a8 140737488347560</em></p> <p><em>rsi 0x7fffffffe198 140737488347544</em></p> <p><em>rdi 0x28 40</em></p> <p><em>rbp 0x7fffffffe090 0x7fffffffe090</em></p> <p><em>rsp 0x7fffffffe090 0x7fffffffe090</em></p> <p><em>r8 0x30555a3c60 207590407264</em></p> <p><em>r9 0x305360ec80 207557291136</em></p> <p><em>r10 0x7fffffffdf40 140737488346944</em></p> <p><em>r11 0x3055221b00 207586728704</em></p> <p><em>r12 0x4003b0 4195248</em></p> <p><em>r13 0x7fffffffe190 140737488347536</em></p> <p><em>r14 0x0 0</em></p> <p><em>r15 0x0 0</em></p> <p><em>rip 0x4004f7 0x4004f7 &lt;func+7&gt;</em></p> <p><em>eflags 0x206 [ PF IF ]</em></p> <p><em>cs 0x33 51</em></p> <p><em>ss 0x2b 43</em></p> <p><em>ds 0x0 0</em></p> <p><em>es 0x0 0</em></p> <p><em>fs 0x0 0</em></p> <p><em>gs 0x0 0</em></p> <p><em>(gdb) info registers rax --------------</em> 查看指定寄存器的信息</p> <p><em>rax 0x400525 4195621</em></p> <p><em>(gdb) n --------------</em> 单步执行</p> <p><em>5  int i = 0;</em></p> <p><em>(gdb)</em></p> <p><em>6  for(i = 0; i &lt; m; i++){</em></p> <p><em>(gdb)</em></p> <p><em>7   n += m;</em></p> <p><em>(gdb) u --------------</em> 执行直至循环结束</p> <p><em>6  for(i = 0; i &lt; m; i++){</em></p> <p><em>(gdb)</em></p> <p><em>10  return n;</em></p> <p><em>(gdb) i r rax --------------</em> 查看指定寄存器<em>rax</em>信息，其存放函数返回值</p> <p><em>rax 0x28 40</em></p> <p><em>(gdb) n --------------</em> 单步执行，此时已经return</p> <p><em>12 }</em></p> <p><em>(gdb) i r rax --------------</em> 查看<em>rax</em>信息，为1600</p> <p><em>rax 0x640 1600</em></p> <p><em>(gdb) set $rax=99 --------------</em> 将<em>rax</em>值修改为99</p> <p><em>(gdb) i r rax --------------</em> 再查看<em>rax</em>，为99</p> <p><em>rax 0x63 99</em></p> <p><em>(gdb) n --------------</em> 单步执行，此时已经退出函数</p> <p><em>main () at test2.c:20</em></p> <p><em>20  for(i = 0; i &lt; 10; i++){</em></p> <p><em>(gdb) p sum -----------</em> 显示sum值，其值应为刚刚*func()*函数的返回值</p> <p><em>$1 = 99 -----------</em> 正确</p> <p><em>(gdb)</em></p> <h1 id="_6-查看程序的堆栈"><a href="#_6-查看程序的堆栈" class="header-anchor">#</a> 6 查看程序的堆栈</h1> <h2 id="_6-1-背景知识"><a href="#_6-1-背景知识" class="header-anchor">#</a> 6.1 背景知识</h2> <p>当你的程序到暂停到断点处时，你需要知道的第一件事就是知道程序停在哪儿，以及通过什么样的函数调用关系到达这里的。</p> <p>每当你的程序调用一个函数，这个函数的相关信息将会生成，该信息包括这个函数在程序中的位置，函数的参数，以及被调用的局部变量的值。这些信息保存在一个数据块中，这个数据块叫做栈框。这些栈框位于内存中称为栈的区域。</p> <p>当你的程序断点处停止，GDB查看堆栈的命令允许你看到所有函数相关的信息。</p> <p>栈被划分为多个连续的块，每个块称为栈框；每个栈框都存有与调用函数相关的数据。栈框中包含了调用函数的参数，调用函数的局部变量。以及这个函数的执行的地址。</p> <p>当程序开始执行时，栈上就只有一个栈框，也就是用来描述Main函数的。这个栈框称为初始化栈框或最外层栈框。每当调用一个函数，一个新的栈框将会生成。每当一个函数结束，该函数对应的栈框将会消除。如果一个函数是递归函数，这将会对同一个函数产生很多个栈框。正在执行函数的栈框将叫做最内层栈框。这个是所有存在栈框中最新创建的。在你的程序里，栈框通过它对应到的地址进行标识。一个栈框由多个字节组成，每个栈框都有自己的地址，当程序执行到这个栈框时。通常这个栈框地址存放在特定的寄存器中。</p> <p>gdb为每个存在的栈框赋上一个标号。标号从0开始，0表示最里层的栈框。也就是正在被调用函数的栈框。这些标号在程序中并不存在，它是由gdb赋予的，gdb通过赋予这个标号来给gdb的命令指定哪个栈框。</p> <h2 id="_6-2-使用命令"><a href="#_6-2-使用命令" class="header-anchor">#</a> 6.2 使用命令</h2> <p><strong>frame args</strong></p> <p>这个frame命令允许你从一个栈框移动到另一个栈框，然后可以打印出你选择的栈框，args要么是栈框的地址，要么是栈框的标号，如果没有参数，frame命令将会打印出当前的栈框。</p> <p><strong>select -frame</strong></p> <p>select -frame命令允许你从一个栈框移动到另外一个栈框而不打印栈框的信息，这个命令可以看作是frame命令的silent版本。</p> <p><strong>backtrace</strong></p> <p><strong>bt</strong></p> <p>bt命令打印栈全部的backtrace，每个栈框显示一行。你可以在任何时间结束backtrace通过键入系统中断字符，ctrl+c。</p> <p><strong>backtrace n</strong></p> <p><strong>bt n</strong></p> <p>bt n 命令将会显示最内层的n个栈框。</p> <p><strong>backtrace -n</strong></p> <p><strong>bt -n</strong></p> <p>bt -n将会显示最外层的n个栈框。</p> <p><strong>backtrace full</strong></p> <p><strong>bt full</strong></p> <p><strong>bt full n</strong></p> <p><strong>bt full -n</strong></p> <p>如果添加full这个参数的话，将会显示栈框中的局部变量。</p> <p><strong>frame n</strong></p> <p><strong>f n</strong></p> <p>frame n(f n)将会选择栈框n,栈框0是最内层的栈框，也就是当前执行的函数，栈框1是调用最内层栈框的函数。最大的栈框就是main函数对应的栈框。</p> <p><strong>frame addr</strong></p> <p><strong>f addr</strong></p> <p>通过栈框的地址选择栈框。如果栈框被bug破坏掉了，这将是主要的方法去查看栈框。栈框破坏掉了，gdb将不能通过栈框标号去定位栈框。另外，如果你的程序有多个栈，在多个栈切换时这中方法将很有用。</p> <p><strong>up n</strong></p> <p>up n将会朝外层栈框走n个。它的方向是朝最外层的栈框，也就是最大的栈框号。</p> <p><strong>down n</strong></p> <p>down n和up n是对应的，它将会朝最内层走n个栈框。</p> <p>这些命令将会打印两行关于该栈框的信息，第一行将会显示栈框号，函数名，参数，以及源代码所在的文件名，和所在的行。</p> <h2 id="_6-3-示例"><a href="#_6-3-示例" class="header-anchor">#</a> 6.3 示例</h2> <h3 id="_6-3-1-源代码test3-c"><a href="#_6-3-1-源代码test3-c" class="header-anchor">#</a> 6.3.1 源代码test3.c</h3> <ol><li>#include &lt;stdio.h&gt;</li> <li></li> <li><strong>int</strong> func4(<strong>int</strong> m)</li> <li>{</li> <li><strong>int</strong> ret = m - m / 2;</li> <li><strong>return</strong> ret;</li> <li>}</li> <li></li> <li><strong>int</strong> func3(<strong>int</strong> m)</li> <li>{</li> <li><strong>int</strong> ret = m + func4(m);</li> <li><strong>return</strong> ret;</li> <li>}</li> <li></li> <li></li> <li><strong>int</strong> func2(<strong>int</strong> m)</li> <li>{</li> <li><strong>int</strong> ret = m * func3(m);</li> <li><strong>return</strong> ret;</li> <li>}</li> <li></li> <li><strong>int</strong> func1(<strong>int</strong> m)</li> <li>{</li> <li><strong>int</strong> ret = func2(m) + 1;</li> <li><strong>return</strong> ret;</li> <li>}</li> <li></li> <li><strong>int</strong> main()</li> <li>{</li> <li><strong>int</strong> m = 40;</li> <li><strong>int</strong> n = func1(m);</li> <li></li> <li><strong>return</strong> 0;</li> <li>}</li> <li></li></ol> <h3 id="_6-3-2-调试过程"><a href="#_6-3-2-调试过程" class="header-anchor">#</a> 6.3.2 调试过程</h3> <p>启动GDB:</p> <p><em>root@luo:~/workspace/test/exec\&gt;gdb -q test3</em></p> <p><em>Reading symbols from /home/luo/workspace/test/exec/test3...done.</em></p> <p><em>(gdb) b main --------------</em> 在main函数设置断点</p> <p><em>Breakpoint 1 at 0x40057d: file ../source/test3.c, line 30.</em></p> <p><em>(gdb) r --------------</em> 运行程序</p> <p><em>Starting program: /home/luo/workspace/test/exec/test3</em></p> <p><em>Breakpoint 1, main () at ../source/test3.c:30</em></p> <p><em>30  int m = 40;</em></p> <p><em>(gdb) s --------------</em> step单步执行</p> <p><em>31  int n = func1(m);</em></p> <p><em>(gdb) s</em></p> <p><em>func1 (m=40) at ../source/test3.c:24</em></p> <p><em>24  int ret = func2(m) + 1;</em></p> <p><em>(gdb) s</em></p> <p><em>func2 (m=40) at ../source/test3.c:18</em></p> <p><em>18  int ret = m * func3(m);</em></p> <p><em>(gdb) s</em></p> <p><em>func3 (m=40) at ../source/test3.c:11</em></p> <p><em>11  int ret = m + func4(m);</em></p> <p><em>(gdb) s</em></p> <p><em>func4 (m=40) at ../source/test3.c:5</em></p> <p><em>5  int ret = m - m / 2;</em></p> <p><em>(gdb) bt --------------</em> 显示栈信息</p> <p><em>#0 func4 (m=40) at ../source/test3.c:5</em></p> <p><em>#1 0x0000000000400527 in func3 (m=40) at ../source/test3.c:11</em></p> <p><em>#2 0x0000000000400549 in func2 (m=40) at ../source/test3.c:18</em></p> <p><em>#3 0x000000000040056a in func1 (m=40) at ../source/test3.c:24</em></p> <p><em>#4 0x000000000040058e in main () at ../source/test3.c:31</em></p> <p><em>(gdb) frame 2 --------------</em> 跳到标号为2的栈框</p> <p><em>#2 0x0000000000400549 in func2 (m=40) at ../source/test3.c:18</em></p> <p><em>18  int ret = m * func3(m);</em></p> <p><em>(gdb) select-frame 2 -------------</em> 跳到标号为2的栈框并且不打印信息</p> <p><em>(gdb) bt 3 --------------</em> 显示最内层的3个栈框</p> <p><em>#0 func4 (m=40) at ../source/test3.c:5</em></p> <p><em>#1 0x0000000000400527 in func3 (m=40) at ../source/test3.c:11</em></p> <p><em>#2 0x0000000000400549 in func2 (m=40) at ../source/test3.c:18</em></p> <p><em>(More stack frames follow...)</em></p> <p><em>(gdb) bt -3 --------------</em> 显示最外层的3个栈框</p> <p><em>#2 0x0000000000400549 in func2 (m=40) at ../source/test3.c:18</em></p> <p><em>#3 0x000000000040056a in func1 (m=40) at ../source/test3.c:24</em></p> <p><em>#4 0x000000000040058e in main () at ../source/test3.c:31</em></p> <p><em>(gdb) bt full --------------</em> 显示栈信息，包括局部变量</p> <p><em>#0 func4 (m=40) at ../source/test3.c:5</em></p> <p><em>ret = 0</em></p> <p><em>#1 0x0000000000400527 in func3 (m=40) at ../source/test3.c:11</em></p> <p><em>ret = 0</em></p> <p><em>#2 0x0000000000400549 in func2 (m=40) at ../source/test3.c:18</em></p> <p><em>ret = 0</em></p> <p><em>#3 0x000000000040056a in func1 (m=40) at ../source/test3.c:24</em></p> <p><em>ret = 0</em></p> <p><em>#4 0x000000000040058e in main () at ../source/test3.c:31</em></p> <p><em>m = 40</em></p> <p><em>n = 0</em></p> <p><em>(gdb) frame 2</em> <em>--------------</em> 移动到标号为2的栈框</p> <p><em>#2 0x0000000000400549 in func2 (m=40) at ../source/test3.c:18</em></p> <p><em>18  int ret = m * func3(m);</em></p> <p><em>(gdb) bt</em></p> <p><em>#0 func4 (m=40) at ../source/test3.c:5</em></p> <p><em>#1 0x0000000000400527 in func3 (m=40) at ../source/test3.c:11</em></p> <p><em>#2 0x0000000000400549 in func2 (m=40) at ../source/test3.c:18</em></p> <p><em>#3 0x000000000040056a in func1 (m=40) at ../source/test3.c:24</em></p> <p><em>#4 0x000000000040058e in main () at ../source/test3.c:31</em></p> <p><em>(gdb) up 2 --------------</em> 向外层栈框移动2层</p> <p><em>#4 0x000000000040058e in main () at ../source/test3.c:31</em></p> <p><em>31  int n = func1(m);</em></p> <p><em>(gdb) down 3 --------------</em> 向内层栈框移动3层</p> <p><em>#1 0x0000000000400527 in func3 (m=40) at ../source/test3.c:11</em></p> <p><em>11  int ret = m + func4(m);</em></p> <p><em>(gdb)</em></p> <h1 id="_7-多线程调试"><a href="#_7-多线程调试" class="header-anchor">#</a> 7 多线程调试</h1> <h2 id="_7-1-使用命令"><a href="#_7-1-使用命令" class="header-anchor">#</a> 7.1 使用命令</h2> <p><strong>info threads</strong></p> <p>查看当前进程的线程。GDB会为每个线程分配一个ID, 后面操作线程的时候会用到这个ID。前面有*的是当前调试的线程。</p> <p><strong>thread &lt;ID&gt;</strong></p> <p>切换调试的线程为指定ID的线程。</p> <p><strong>break file.c:number thread all</strong></p> <p>在file.c文件第number行处为所有经过这里的线程设置断点。</p> <p><strong>set scheduler-locking off|on|step</strong></p> <p>在使用step或者continue命令调试当前被调试线程的时候，其他线程也是同时执行的, 怎么只让被调试程序执行呢？</p> <p>通过这个命令就可以实现这个需求。</p> <p>off 不锁定任何线程，也就是所有线程都执行，这是默认值。</p> <p>on 只有当前被调试程序会执行。</p> <p>step 在单步的时候，除了next过一个函数的情况 (熟悉情况的人可能知道，这其实是一个设置断点然后continue的行为)以外，只有当前线程会执行。</p> <p><strong>thread apply ID1 ID2 command</strong></p> <p>让一个或多个线程执行GDB命令command。</p> <p><strong>thread apply all command</strong></p> <p>让所有被调试线程执行GDB命令command。</p> <h2 id="_7-2-示例"><a href="#_7-2-示例" class="header-anchor">#</a> 7.2 示例</h2> <h3 id="_7-2-1-源代码test4-c"><a href="#_7-2-1-源代码test4-c" class="header-anchor">#</a> 7.2.1 源代码test4.c</h3> <ol><li>/*</li> <li>* 本文件为多线程调试测试准备</li> <li>*/</li> <li>#include &lt;stdio.h&gt;</li> <li>#include &lt;stdlib.h&gt;</li> <li>#include &lt;pthread.h&gt;</li> <li>#include &lt;unistd.h&gt;</li> <li></li> <li><strong>void</strong> func1()</li> <li>{</li> <li><strong>int</strong> i = 0;</li> <li><strong>while</strong>(1){</li> <li>i++;</li> <li>printf(&quot;**********************************\n&quot;);</li> <li>printf(&quot;this is function 1!\n&quot;);</li> <li>printf(&quot;this is %d time!\n&quot;, i);</li> <li>sleep(1);</li> <li>}</li> <li></li> <li><strong>return</strong> ;</li> <li>}</li> <li></li> <li><strong>void</strong> func2()</li> <li>{</li> <li><strong>int</strong> i = 0;</li> <li><strong>while</strong>(1){</li> <li>i++;</li> <li>printf(&quot;**********************************\n&quot;);</li> <li>printf(&quot;this is function 2!\n&quot;);</li> <li>printf(&quot;this is %d time!\n&quot;, i);</li> <li>sleep(1);</li> <li>}</li> <li><strong>return</strong> ;</li> <li>}</li> <li></li> <li></li> <li><strong>int</strong> main()</li> <li>{</li> <li>pthread_t td1, td2, td3;</li> <li><strong>int</strong> ret_td1, ret_td2, ret_td3;</li> <li></li> <li>ret_td1 = pthread_create(&amp;td1, NULL, (<strong>void</strong>*)&amp;func1, NULL);</li> <li>ret_td2 = pthread_create(&amp;td2, NULL, (<strong>void</strong>*)&amp;func2, NULL);</li> <li>ret_td3 = pthread_create(&amp;td3, NULL, (<strong>void</strong>*)&amp;func2, NULL);</li> <li></li> <li><strong>if</strong>(ret_td1 != 0){</li> <li>printf(&quot;线程1创建失败\n&quot;);</li> <li>}<strong>else</strong>{</li> <li>printf(&quot;线程1创建成功\n&quot;);</li> <li>}</li> <li></li> <li><strong>if</strong>(ret_td2 != 0){</li> <li>printf(&quot;线程2创建失败\n&quot;);</li> <li>}<strong>else</strong>{</li> <li>printf(&quot;线程2创建成功\n&quot;);</li> <li>}</li> <li></li> <li><strong>if</strong>(ret_td3 != 0){</li> <li>printf(&quot;线程3创建失败\n&quot;);</li> <li>}<strong>else</strong>{</li> <li>printf(&quot;线程3创建成功\n&quot;);</li> <li>}</li> <li></li> <li><strong>return</strong> 0;</li> <li>}</li></ol> <h3 id="_7-2-2-调试过程"><a href="#_7-2-2-调试过程" class="header-anchor">#</a> 7.2.2 调试过程</h3> <p>编译生成可执行文件，注意带上 <em>-lpthread</em> ：</p> <p><em>root@luo:~/workspace/test/exec\&gt;gcc -g ../source/test4.c -o test4 -lpthread</em></p> <p>启动GDB:</p> <p><em>root@luo:~/workspace/test/exec\&gt;gdb -q test4</em></p> <p><em>Reading symbols from /home/luo/workspace/test/exec/test4...done.</em></p> <p><em>(gdb) b main --------------</em> 在main()函数设置断点</p> <p><em>Breakpoint 1 at 0x400776: file ../source/test4.c, line 42.</em></p> <p><em>(gdb) l 1 --------------</em> 列出源代码</p> <p><em>1 /*</em></p> <p><em>2 * 本文件为多线程调试测试准备</em></p> <p><em>3 */</em></p> <p><em>4 #include &lt;stdio.h&gt;</em></p> <p><em>5 #include &lt;stdlib.h&gt;</em></p> <p><em>6 #include &lt;pthread.h&gt;</em></p> <p><em>7 #include &lt;unistd.h&gt;</em></p> <p><em>8</em></p> <p><em>9 void func1()</em></p> <p><em>10 {</em></p> <p><em>(gdb)</em></p> <p><em>11  int i = 0;</em></p> <p><em>12  while(1){</em></p> <p><em>13   i++;</em></p> <p><em>14   printf(&quot;**********************************\n&quot;);</em></p> <p><em>15   printf(&quot;this is function 1!\n&quot;);</em></p> <p><em>16   printf(&quot;this is %d time!\n&quot;, i);</em></p> <p><em>17   sleep(1);</em></p> <p><em>18  }</em></p> <p><em>19</em></p> <p><em>20  return ;</em></p> <p><em>(gdb)</em></p> <p><em>21 }</em></p> <p><em>22</em></p> <p><em>23 void func2()</em></p> <p><em>24 {</em></p> <p><em>25  int i = 0;</em></p> <p><em>26  while(1){</em></p> <p><em>27   i++;</em></p> <p><em>28   printf(&quot;**********************************\n&quot;);</em></p> <p><em>29   printf(&quot;this is function 2!\n&quot;);</em></p> <p><em>30   printf(&quot;this is %d time!\n&quot;, i);</em></p> <p><em>(gdb)</em></p> <p><em>31   sleep(1);</em></p> <p><em>32  }</em></p> <p><em>33  return ;</em></p> <p><em>34 }</em></p> <p><em>35</em></p> <p><em>36</em></p> <p><em>37 int main()</em></p> <p><em>38 {</em></p> <p><em>39  pthread_t td1, td2, td3;</em></p> <p><em>40  int ret_td1, ret_td2, ret_td3;</em></p> <p><em>(gdb)</em></p> <p><em>41</em></p> <p><em>42  ret_td1 = pthread_create(&amp;td1, NULL, (void*)&amp;func1, NULL);</em></p> <p><em>43  ret_td2 = pthread_create(&amp;td2, NULL, (void*)&amp;func2, NULL);</em></p> <p><em>44  ret_td3 = pthread_create(&amp;td3, NULL, (void*)&amp;func2, NULL);</em></p> <p><em>45</em></p> <p><em>46  if(ret_td1 != 0){</em></p> <p><em>47   printf(&quot;线程1创建失败\n&quot;);</em></p> <p><em>48  }else{</em></p> <p><em>49   printf(&quot;线程1创建成功\n&quot;);</em></p> <p><em>50  }</em></p> <p><em>(gdb)</em></p> <p><em>51</em></p> <p><em>52  if(ret_td2 != 0){</em></p> <p><em>53   printf(&quot;线程2创建失败\n&quot;);</em></p> <p><em>54  }else{</em></p> <p><em>55   printf(&quot;线程2创建成功\n&quot;);</em></p> <p><em>56  }</em></p> <p><em>57</em></p> <p><em>58  if(ret_td3 != 0){</em></p> <p><em>59   printf(&quot;线程3创建失败\n&quot;);</em></p> <p><em>60  }else{</em></p> <p><em>(gdb)</em></p> <p><em>61   printf(&quot;线程3创建成功\n&quot;);</em></p> <p><em>62  }</em></p> <p><em>63</em></p> <p><em>64  return 0;</em></p> <p><em>65 }</em></p> <p><em>(gdb) b 18 --------------</em> 在18行设置断点</p> <p><em>Breakpoint 2 at 0x400725: file ../source/test4.c, line 18.</em></p> <p><em>(gdb) b 32 --------------</em> 在32行设置断点</p> <p><em>Breakpoint 3 at 0x40076c: file ../source/test4.c, line 32.</em></p> <p><em>(gdb) b 46 --------------</em> 在46行设置断点</p> <p><em>Breakpoint 4 at 0x4007d0: file ../source/test4.c, line 46.</em></p> <p><em>(gdb) r --------------</em> 运行程序</p> <p><em>Starting program: /home/luo/workspace/test/exec/test4</em></p> <p><em>[Thread debugging using libthread_db enabled]</em></p> <p><em>Using host libthread_db library &quot;/lib64/libthread_db.so.1&quot;.</em></p> <p><em>Breakpoint 1, main () at ../source/test4.c:42</em></p> <p><em>42  ret_td1 = pthread_create(&amp;td1, NULL, (void*)&amp;func1, NULL);</em></p> <p><em>(gdb) info threads --------------</em> 查看线程信息，目前只有一个主线程</p> <p><em>Id Target Id Frame</em></p> <p><em>* 1 Thread 0x7ffff7dd2700 (LWP 40907) &quot;test4&quot; main ()</em></p> <p><em>at ../source/test4.c:42</em></p> <p><em>(gdb) c --------------</em> 继续运行程序</p> <p><em>Continuing.</em></p> <p><em>[New Thread 0x7ffff7dd0700 (LWP 40913)] --------------</em> 新线程创建</p> <p><em>**********************************</em></p> <p><em>[New Thread 0x7ffff75cf700 (LWP 40914)] --------------</em> 新线程创建</p> <p><em>this is function 1!</em></p> <p><em>this is 1 time!</em></p> <p><em>[New Thread 0x7ffff6dce700 (LWP 40915)] --------------</em> 新线程创建</p> <p><em>**********************************</em></p> <p><em>Breakpoint 4, main () at ../source/test4.c:46</em></p> <p><em>46  if(ret_td1 != 0){</em></p> <p><em>(gdb) info threads --------------</em> 查看线程信息</p> <p><em>Id Target Id Frame</em></p> <p><em>4 Thread 0x7ffff6dce700 (LWP 40915) &quot;test4&quot; 0x00000030552d795d in write () from /lib64/libc.so.6</em></p> <p><em>3 Thread 0x7ffff75cf700 (LWP 40914) &quot;test4&quot; __lll_lock_wait_private ()</em></p> <p><em>at ../nptl/sysdeps/unix/sysv/linux/x86_64/lowlevellock.S:95</em></p> <p><em>2 Thread 0x7ffff7dd0700 (LWP 40913) &quot;test4&quot; 0x00000030552b5a0d in nanosleep () from /lib64/libc.so.6</em></p> <p><em>* 1 Thread 0x7ffff7dd2700 (LWP 40907) &quot;test4&quot; main ()</em></p> <p><em>at ../source/test4.c:46</em></p> <p><em>(gdb) set scheduler-locking on --------------</em> 设置调试模式为只有当前线程会被执行</p> <p><em>(gdb) thread 4 --------------</em> 切换到4号线程</p> <p><em>[Switching to thread 4 (Thread 0x7ffff6dce700 (LWP 40915))]</em></p> <p><em>#0 0x00000030552d795d in write () from /lib64/libc.so.6</em></p> <p><em>(gdb) c --------------</em> 当前线程执行continue</p> <p><em>Continuing.</em></p> <p><em>this is function 2!</em></p> <p><em>this is 1 time!</em></p> <p><em>Breakpoint 3, func2 () at ../source/test4.c:32</em></p> <p><em>32  }</em></p> <p><em>(gdb) c</em></p> <p><em>Continuing.</em></p> <p><em>**********************************</em></p> <p><em>this is function 2!</em></p> <p><em>this is 2 time!</em></p> <p><em>Breakpoint 3, func2 () at ../source/test4.c:32</em></p> <p><em>32  }</em></p> <p><em>(gdb) thread 3 --------------</em> 切换线程</p> <p><em>[Switching to thread 3 (Thread 0x7ffff75cf700 (LWP 40914))]</em></p> <p><em>#0 __lll_lock_wait_private ()</em></p> <p><em>at ../nptl/sysdeps/unix/sysv/linux/x86_64/lowlevellock.S:95</em></p> <p><em>95 ../nptl/sysdeps/unix/sysv/linux/x86_64/lowlevellock.S: No such file or directory.</em></p> <p><em>(gdb) c</em></p> <p><em>Continuing.</em></p> <p><em>**********************************</em></p> <p><em>this is function 2!</em></p> <p><em>this is 1 time!</em></p> <p><em>Breakpoint 3, func2 () at ../source/test4.c:32</em></p> <p><em>32  }</em></p> <p><em>(gdb) c</em></p> <p><em>Continuing.</em></p> <p><em>**********************************</em></p> <p><em>this is function 2!</em></p> <p><em>this is 2 time!</em></p> <p><em>Breakpoint 3, func2 () at ../source/test4.c:32</em></p> <p><em>32  }</em></p> <p><em>(gdb) thread 2 --------------</em> 切换线程</p> <p><em>[Switching to thread 2 (Thread 0x7ffff7dd0700 (LWP 40913))]</em></p> <p><em>#0 0x00000030552f081b in ?? () from /lib64/libc.so.6</em></p> <p><em>(gdb) c</em></p> <p><em>Continuing.</em></p> <p><em>**********************************</em></p> <p><em>this is function 1!</em></p> <p><em>this is 2 time!</em></p> <p><em>Breakpoint 2, func1 () at ../source/test4.c:18</em></p> <p><em>18  }</em></p> <p><em>(gdb) c</em></p> <p><em>Continuing.</em></p> <p><em>**********************************</em></p> <p><em>this is function 1!</em></p> <p><em>this is 3 time!</em></p> <p><em>Breakpoint 2, func1 () at ../source/test4.c:18</em></p> <p><em>18  }</em></p> <p><em>(gdb) info threads --------------</em> 查看线程信息，当前位于2号线程</p> <p><em>Id Target Id Frame</em></p> <p><em>4 Thread 0x7ffff6dce700 (LWP 40915) &quot;test4&quot; func2 ()</em></p> <p><em>at ../source/test4.c:32</em></p> <p><em>3 Thread 0x7ffff75cf700 (LWP 40914) &quot;test4&quot; func2 ()</em></p> <p><em>at ../source/test4.c:32</em></p> <p><em>* 2 Thread 0x7ffff7dd0700 (LWP 40913) &quot;test4&quot; func1 ()</em></p> <p><em>at ../source/test4.c:18</em></p> <p><em>1 Thread 0x7ffff7dd2700 (LWP 40907) &quot;test4&quot; main ()</em></p> <p><em>at ../source/test4.c:46</em></p> <p><em>(gdb) thread apply 2 4 continue -----</em> 令2号和4号线程执行continue</p> <p><em>Thread 2 (Thread 0x7ffff7dd0700 (LWP 40913)):</em></p> <p><em>Continuing.</em></p> <p><em>**********************************</em></p> <p><em>this is function 1!</em></p> <p><em>this is 4 time!</em></p> <p><em>Breakpoint 2, func1 () at ../source/test4.c:18</em></p> <p><em>18  }</em></p> <p><em>Thread 4 (Thread 0x7ffff6dce700 (LWP 40915)):</em></p> <p><em>Continuing.</em></p> <p><em>**********************************</em></p> <p><em>this is function 2!</em></p> <p><em>this is 3 time!</em></p> <p><em>Breakpoint 3, func2 () at ../source/test4.c:32</em></p> <p><em>32  }</em></p> <p><em>(gdb) thread apply all continue -------------</em> 所有线程执行continue</p> <p><em>Thread 4 (Thread 0x7ffff6dce700 (LWP 40915)):</em></p> <p><em>Continuing.</em></p> <p><em>**********************************</em></p> <p><em>this is function 2!</em></p> <p><em>this is 4 time!</em></p> <p><em>Breakpoint 3, func2 () at ../source/test4.c:32</em></p> <p><em>32  }</em></p> <p><em>Thread 3 (Thread 0x7ffff75cf700 (LWP 40914)):</em></p> <p><em>Continuing.</em></p> <p><em>**********************************</em></p> <p><em>this is function 2!</em></p> <p><em>this is 3 time!</em></p> <p><em>Breakpoint 3, func2 () at ../source/test4.c:32</em></p> <p><em>32  }</em></p> <p><em>Thread 2 (Thread 0x7ffff7dd0700 (LWP 40913)):</em></p> <p><em>Continuing.</em></p> <p><em>**********************************</em></p> <p><em>this is function 1!</em></p> <p><em>this is 5 time!</em></p> <p><em>Breakpoint 2, func1 () at ../source/test4.c:18</em></p> <p><em>18  }</em></p> <p><em>Thread 1 (Thread 0x7ffff7dd2700 (LWP 40907)):</em></p> <p><em>Continuing.</em></p> <p><em>线程1创建成功</em></p> <p><em>线程2创建成功</em></p> <p><em>线程3创建成功</em></p> <p><em>[Thread 0x7ffff6dce700 (LWP 40915) exited]</em></p> <p><em>[Thread 0x7ffff75cf700 (LWP 40914) exited]</em></p> <p><em>[Thread 0x7ffff7dd0700 (LWP 40913) exited]</em></p> <p><em>[Inferior 1 (process 40907) exited normally]</em></p> <p><em>(gdb)</em></p> <h1 id="_8-死锁调试"><a href="#_8-死锁调试" class="header-anchor">#</a> 8 死锁调试</h1> <h2 id="_8-1-使用命令"><a href="#_8-1-使用命令" class="header-anchor">#</a> 8.1 使用命令</h2> <p><strong>ps -ef|grep &lt;processname&gt;</strong></p> <p>查看进程号，其中processname为进程名。</p> <p><strong>gdb attach &lt;PID&gt;</strong></p> <p>使用GDB调试正在运行的进程。</p> <h2 id="_8-2-示例"><a href="#_8-2-示例" class="header-anchor">#</a> 8.2 示例</h2> <h3 id="_8-2-1-源文件test5-c"><a href="#_8-2-1-源文件test5-c" class="header-anchor">#</a> 8.2.1 源文件test5.c</h3> <ol><li>/*</li> <li>*本文件用于测试死锁调试</li> <li>*</li> <li>*代码来自网络：http://blog.chinaunix.net/uid-30343738-id-5757210.html</li> <li>*</li> <li>*/</li> <li></li> <li>#include &lt;stdio.h&gt;</li> <li>#include &lt;stdlib.h&gt;</li> <li>#include &lt;unistd.h&gt;</li> <li>#include &lt;string.h&gt;</li> <li>#include &lt;pthread.h&gt;</li> <li></li> <li>pthread_mutex_t mutex1 = PTHREAD_MUTEX_INITIALIZER;</li> <li>pthread_mutex_t mutex2 = PTHREAD_MUTEX_INITIALIZER;</li> <li>pthread_mutex_t mutex3 = PTHREAD_MUTEX_INITIALIZER;</li> <li>pthread_mutex_t mutex4 = PTHREAD_MUTEX_INITIALIZER;</li> <li></li> <li><strong>static</strong> <strong>int</strong> sequence1 = 0;</li> <li><strong>static</strong> <strong>int</strong> sequence2 = 0;</li> <li></li> <li><strong>int</strong> func1()</li> <li>{</li> <li>pthread_mutex_lock(&amp;mutex1);</li> <li>++sequence1;</li> <li>sleep(1);</li> <li>pthread_mutex_lock(&amp;mutex2);</li> <li>++sequence2;</li> <li>pthread_mutex_unlock(&amp;mutex2);</li> <li>pthread_mutex_unlock(&amp;mutex1);</li> <li></li> <li><strong>return</strong> sequence1;</li> <li>}</li> <li></li> <li><strong>int</strong> func2()</li> <li>{</li> <li>pthread_mutex_lock(&amp;mutex2);</li> <li>++sequence2;</li> <li>sleep(1);</li> <li>pthread_mutex_lock(&amp;mutex1);</li> <li>++sequence1;</li> <li>pthread_mutex_unlock(&amp;mutex1);</li> <li>pthread_mutex_unlock(&amp;mutex2);</li> <li></li> <li><strong>return</strong> sequence2;</li> <li>}</li> <li></li> <li><strong>void</strong>* thread1(<strong>void</strong>* arg)</li> <li>{</li> <li><strong>while</strong> (1)</li> <li>{</li> <li><strong>int</strong> iRetValue = func1();</li> <li></li> <li><strong>if</strong> (iRetValue == 100000)</li> <li>{</li> <li>pthread_exit(NULL);</li> <li>}</li> <li>}</li> <li>}</li> <li></li> <li><strong>void</strong>* thread2(<strong>void</strong>* arg)</li> <li>{</li> <li><strong>while</strong> (1)</li> <li>{</li> <li><strong>int</strong> iRetValue = func2();</li> <li></li> <li><strong>if</strong> (iRetValue == 100000)</li> <li>{</li> <li>pthread_exit(NULL);</li> <li>}</li> <li>}</li> <li>}</li> <li></li> <li><strong>void</strong>* thread3(<strong>void</strong>* arg)</li> <li>{</li> <li><strong>while</strong> (1)</li> <li>{</li> <li>sleep(1);</li> <li><strong>char</strong> szBuf[128];</li> <li>memset(szBuf, 0, <strong>sizeof</strong>(szBuf));</li> <li>strcpy(szBuf, &quot;thread3&quot;);</li> <li>}</li> <li>}</li> <li></li> <li><strong>void</strong>* thread4(<strong>void</strong>* arg)</li> <li>{</li> <li><strong>while</strong> (1)</li> <li>{</li> <li>sleep(1);</li> <li><strong>char</strong> szBuf[128];</li> <li>memset(szBuf, 0, <strong>sizeof</strong>(szBuf));</li> <li>strcpy(szBuf, &quot;thread3&quot;);</li> <li>}</li> <li>}</li> <li></li> <li><strong>int</strong> main()</li> <li>{</li> <li>pthread_t tid[4];</li> <li><strong>if</strong> (pthread_create(&amp;tid[0], NULL, &amp;thread1, NULL) != 0)</li> <li>{</li> <li>_exit(1);</li> <li>}</li> <li><strong>if</strong> (pthread_create(&amp;tid[1], NULL, &amp;thread2, NULL) != 0)</li> <li>{</li> <li>_exit(1);</li> <li>}</li> <li><strong>if</strong> (pthread_create(&amp;tid[2], NULL, &amp;thread3, NULL) != 0)</li> <li>{</li> <li>_exit(1);</li> <li>}</li> <li><strong>if</strong> (pthread_create(&amp;tid[3], NULL, &amp;thread4, NULL) != 0)</li> <li>{</li> <li>_exit(1);</li> <li>}</li> <li></li> <li>sleep(5);</li> <li>//pthread_cancel(tid[0]);</li> <li></li> <li>pthread_join(tid[0], NULL);</li> <li>pthread_join(tid[1], NULL);</li> <li>pthread_join(tid[2], NULL);</li> <li>pthread_join(tid[3], NULL);</li> <li></li> <li>pthread_mutex_destroy(&amp;mutex1);</li> <li>pthread_mutex_destroy(&amp;mutex2);</li> <li>pthread_mutex_destroy(&amp;mutex3);</li> <li>pthread_mutex_destroy(&amp;mutex4);</li> <li></li> <li><strong>return</strong> 0;</li> <li>}</li></ol> <h3 id="_8-2-2-调试过程"><a href="#_8-2-2-调试过程" class="header-anchor">#</a> 8.2.2 调试过程</h3> <p>执行程序，程序会卡在这里：</p> <p><a href="mailto:root@luo:~/workspace/test/exec%3e./test5"><em>root@luo:~/workspace/test/exec\&gt;./test5</em></a></p> <p>另开一个终端，查看进程的信息：</p> <p><em>root@luo:~/workspace/test/exec\&gt;ps -ef|grep test5</em></p> <p><em>root 42746 39442 0 14:25 ttyp0 00:00:00 ./test5</em></p> <p><em>root 43464 42753 0 15:11 ttyp2 00:00:00 grep --color=auto test5</em></p> <p>使用GDB工具attach该进程：</p> <p><em>root@luo:~/workspace/test/exec\&gt;gdb -q attach 42746</em></p> <p><em>attach: No such file or directory.</em></p> <p><em>Attaching to process 42746</em></p> <p><em>Reading symbols from /home/luo/workspace/test/exec/test5...done.</em></p> <p><em>Reading symbols from /lib64/libpthread.so.0...done.</em></p> <p><em>[New LWP 42750]</em></p> <p><em>[New LWP 42749]</em></p> <p><em>[New LWP 42748]</em></p> <p><em>[New LWP 42747]</em></p> <p><em>[Thread debugging using libthread_db enabled]</em></p> <p><em>Using host libthread_db library &quot;/lib64/libthread_db.so.1&quot;.</em></p> <p><em>Loaded symbols for /lib64/libpthread.so.0</em></p> <p><em>Reading symbols from /lib64/libc.so.6...(no debugging symbols found)...done.</em></p> <p><em>Loaded symbols for /lib64/libc.so.6</em></p> <p><em>Reading symbols from /lib64/ld-linux-x86-64.so.2...(no debugging symbols found)...done.</em></p> <p><em>Loaded symbols for /lib64/ld-linux-x86-64.so.2</em></p> <p><em>0x00007fc3aa9ff492 in pthread_join (threadid=140478357907200, thread_return=0x0)</em></p> <p><em>at pthread_join.c:92</em></p> <p><em>92 pthread_join.c: No such file or directory.</em></p> <p><em>(gdb) info threads  -------------</em> 查看线程信息</p> <p><em>Id Target Id Frame</em></p> <p><em>5 Thread 0x7fc3aa9f2700 (LWP 42747) &quot;test5&quot; __lll_lock_wait ()</em></p> <p><em>at ../nptl/sysdeps/unix/sysv/linux/x86_64/lowlevellock.S:135</em></p> <p><em>4 Thread 0x7fc3aa1f1700 (LWP 42748) &quot;test5&quot; __lll_lock_wait ()</em></p> <p><em>at ../nptl/sysdeps/unix/sysv/linux/x86_64/lowlevellock.S:135</em></p> <p><em>3 Thread 0x7fc3a99f0700 (LWP 42749) &quot;test5&quot; 0x00000030552b5a0d in nanosleep</em></p> <p><em>() from /lib64/libc.so.6</em></p> <p><em>2 Thread 0x7fc3a91ef700 (LWP 42750) &quot;test5&quot; 0x00000030552b5a0d in nanosleep</em></p> <p><em>() from /lib64/libc.so.6</em></p> <p><em>* 1 Thread 0x7fc3aa9f4700 (LWP 42746) &quot;test5&quot; 0x00007fc3aa9ff492 in pthread_join (threadid=140478357907200, thread_return=0x0) at pthread_join.c:92</em></p> <p><em>(gdb) set scheduler-locking on ---------</em> 设置调试模式为只有当前线程会执行</p> <p><em>(gdb) thread apply all bt -------------</em> 显示所有线程的栈信息</p> <p><em>Thread 5 (Thread 0x7fc3aa9f2700 (LWP 42747)):</em></p> <p><em>#0 __lll_lock_wait ()</em></p> <p><em>at ../nptl/sysdeps/unix/sysv/linux/x86_64/lowlevellock.S:135</em></p> <p><em>#1 0x00007fc3aaa00457 in _L_lock_913 () from /lib64/libpthread.so.0</em></p> <p><em>#2 0x00007fc3aaa00280 in __GI___pthread_mutex_lock (mutex=0x6012c0 &lt;mutex2&gt;)</em></p> <p><em>at ../nptl/pthread_mutex_lock.c:79</em></p> <p><em>#3 0x00000000004008b1 in func1 () at test5.c:27</em></p> <p><em>#4 0x000000000040094e in thread1 (arg=0x0) at test5.c:52</em></p> <p><em>#5 0x00007fc3aa9fe092 in start_thread (arg=0x7fc3aa9f2700)</em></p> <p><em>at pthread_create.c:309</em></p> <p><em>#6 0x00000030552e42bd in clone () from /lib64/libc.so.6</em></p> <p><em>Thread 4 (Thread 0x7fc3aa1f1700 (LWP 42748)):</em></p> <p><em>#0 __lll_lock_wait ()</em></p> <p><em>at ../nptl/sysdeps/unix/sysv/linux/x86_64/lowlevellock.S:135</em></p> <p><em>#1 0x00007fc3aaa00457 in _L_lock_913 () from /lib64/libpthread.so.0</em></p> <p><em>#2 0x00007fc3aaa00280 in __GI___pthread_mutex_lock (mutex=0x601280 &lt;mutex1&gt;)</em></p> <p><em>at ../nptl/pthread_mutex_lock.c:79</em></p> <p><em>#3 0x000000000040090d in func2 () at test5.c:40</em></p> <p><em>#4 0x000000000040097c in thread2 (arg=0x0) at test5.c:65</em></p> <p><em>#5 0x00007fc3aa9fe092 in start_thread (arg=0x7fc3aa1f1700)</em></p> <p><em>at pthread_create.c:309</em></p> <p><em>#6 0x00000030552e42bd in clone () from /lib64/libc.so.6</em></p> <p><em>Thread 3 (Thread 0x7fc3a99f0700 (LWP 42749)):</em></p> <p><em>#0 0x00000030552b5a0d in nanosleep () from /lib64/libc.so.6</em></p> <p><em>#1 0x00000030552b58a4 in sleep () from /lib64/libc.so.6</em></p> <p><em>#2 0x00000000004009b0 in thread3 (arg=0x0) at test5.c:78</em></p> <p><em>#3 0x00007fc3aa9fe092 in start_thread (arg=0x7fc3a99f0700)</em></p> <p><em>at pthread_create.c:309</em></p> <p><em>#4 0x00000030552e42bd in clone () from /lib64/libc.so.6</em></p> <p><em>Thread 2 (Thread 0x7fc3a91ef700 (LWP 42750)):</em></p> <p><em>#0 0x00000030552b5a0d in nanosleep () from /lib64/libc.so.6</em></p> <p><em>#1 0x00000030552b58a4 in sleep () from /lib64/libc.so.6</em></p> <p><em>#2 0x00000000004009f5 in thread4 (arg=0x0) at test5.c:89</em></p> <p><em>#3 0x00007fc3aa9fe092 in start_thread (arg=0x7fc3a91ef700)</em></p> <p><em>at pthread_create.c:309</em></p> <p><em>#4 0x00000030552e42bd in clone () from /lib64/libc.so.6</em></p> <p><em>---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---</em></p> <p><em>Thread 1 (Thread 0x7fc3aa9f4700 (LWP 42746)):</em></p> <p><em>#0 0x00007fc3aa9ff492 in pthread_join (threadid=140478357907200,</em></p> <p><em>thread_return=0x0) at pthread_join.c:92</em></p> <p><em>#1 0x0000000000400af1 in main () at test5.c:119</em></p> <p>从栈信息可以初步判断，有可能是4号和5号线程锁住了。</p> <p>查看27行和40行源文件的代码：</p> <p><em>(gdb) l test5.c:27</em></p> <p><em>22 int func1()</em></p> <p><em>23 {</em></p> <p><em>24  pthread_mutex_lock(&amp;mutex1);</em></p> <p><em>25  ++sequence1;</em></p> <p><em>26  sleep(1);</em></p> <p><em>27  pthread_mutex_lock(&amp;mutex2);</em></p> <p><em>28  ++sequence2;</em></p> <p><em>29  pthread_mutex_unlock(&amp;mutex2);</em></p> <p><em>30  pthread_mutex_unlock(&amp;mutex1);</em></p> <p><em>31</em></p> <p><em>(gdb) l test5.c:40</em></p> <p><em>35 int func2()</em></p> <p><em>36 {</em></p> <p><em>37  pthread_mutex_lock(&amp;mutex2);</em></p> <p><em>38  ++sequence2;</em></p> <p><em>39  sleep(1);</em></p> <p><em>40  pthread_mutex_lock(&amp;mutex1);</em></p> <p><em>41  ++sequence1;</em></p> <p><em>42  pthread_mutex_unlock(&amp;mutex1);</em></p> <p><em>43  pthread_mutex_unlock(&amp;mutex2);</em></p> <p><em>44</em></p> <p>看一下4号和5号线程是不是锁住了：</p> <p><em>(gdb) thread 5 -------------</em> 切换到5号线程</p> <p><em>[Switching to thread 5 (Thread 0x7fc3aa9f2700 (LWP 42747))]</em></p> <p><em>#0 __lll_lock_wait ()</em></p> <p><em>at ../nptl/sysdeps/unix/sysv/linux/x86_64/lowlevellock.S:135</em></p> <p><em>135 ../nptl/sysdeps/unix/sysv/linux/x86_64/lowlevellock.S: No such file or directory.</em></p> <p><em>(gdb) n -------------</em> 执行下一步，卡住，Ctrl+C跳出</p> <p><em>^C</em></p> <p><em>Program received signal SIGINT, Interrupt.</em></p> <p><em>__lll_lock_wait () at ../nptl/sysdeps/unix/sysv/linux/x86_64/lowlevellock.S:135</em></p> <p><em>135 in ../nptl/sysdeps/unix/sysv/linux/x86_64/lowlevellock.S</em></p> <p><em>(gdb) thread 2 -------------</em> 切换到2号线程</p> <p><em>[Switching to thread 2 (Thread 0x7fc3a91ef700 (LWP 42750))]</em></p> <p><em>#0 0x00000030552b5a0d in nanosleep () from /lib64/libc.so.6</em></p> <p><em>(gdb) n -------------</em> 执行下一步，可正常执行</p> <p><em>Single stepping until exit from function nanosleep,</em></p> <p><em>which has no line number information.</em></p> <p><em>0x00000030552b58a4 in sleep () from /lib64/libc.so.6</em></p> <p><em>(gdb) n</em></p> <p><em>Single stepping until exit from function sleep,</em></p> <p><em>which has no line number information.</em></p> <p><em>thread4 (arg=0x0) at test5.c:91</em></p> <p><em>91   memset(szBuf, 0, sizeof(szBuf));</em></p> <p><em>(gdb) thread 4 -------------</em> 切换到4号线程</p> <p><em>[Switching to thread 4 (Thread 0x7fc3aa1f1700 (LWP 42748))]</em></p> <p><em>#0 __lll_lock_wait ()</em></p> <p><em>at ../nptl/sysdeps/unix/sysv/linux/x86_64/lowlevellock.S:135</em></p> <p><em>135 ../nptl/sysdeps/unix/sysv/linux/x86_64/lowlevellock.S: No such file or directory.</em></p> <p><em>(gdb) n -------------</em> 执行下一步，卡住</p> <p><em>^C^C</em></p> <p><em>Program received signal SIGINT, Interrupt.</em></p> <p><em>__lll_lock_wait () at ../nptl/sysdeps/unix/sysv/linux/x86_64/lowlevellock.S:135</em></p> <p><em>135 in ../nptl/sysdeps/unix/sysv/linux/x86_64/lowlevellock.S</em></p> <p><em>(gdb)</em></p> <p>以上方法可调试找出程序中出现死锁的地方。</p> <h1 id="_9-core文件调试"><a href="#_9-core文件调试" class="header-anchor">#</a> 9 core文件调试</h1> <h2 id="_9-1-使用命令"><a href="#_9-1-使用命令" class="header-anchor">#</a> 9.1 使用命令</h2> <p><strong>ulimit -c</strong></p> <p>查看core文件生成的大小限制，若为0，则表示不会生成core文件。（注：ulimit不会影响其他shell终端）</p> <p><strong>ulimit -c &lt;size&gt;</strong></p> <p>设置core文件生成的大小。</p> <p><strong>cat /proc/sys/kernel/core_pattern</strong></p> <p>查看core文件路径。</p> <p><strong>gdb &lt;a.out&gt; &lt;corefile&gt;</strong></p> <p>调试core文件</p> <h2 id="_9-2-示例"><a href="#_9-2-示例" class="header-anchor">#</a> 9.2 示例</h2> <h3 id="_9-2-1-源代码test6-c"><a href="#_9-2-1-源代码test6-c" class="header-anchor">#</a> 9.2.1 源代码test6.c</h3> <p>一个能产生core dump的程序</p> <ol><li>#include &lt;stdio.h&gt;</li> <li><strong>static</strong> <strong>void</strong> sub(<strong>void</strong>);</li> <li><strong>int</strong> main(<strong>void</strong>)</li> <li>{</li> <li>sub();</li> <li><strong>return</strong> 0;</li> <li>}</li> <li><strong>static</strong> <strong>void</strong> sub(<strong>void</strong>)</li> <li>{</li> <li><strong>int</strong> *p = NULL;</li> <li>/* derefernce a null pointer, expect coredump. */</li> <li>printf(&quot;%d&quot;, *p);</li> <li>}</li></ol> <h3 id="_9-2-2-调试过程"><a href="#_9-2-2-调试过程" class="header-anchor">#</a> 9.2.2 调试过程</h3> <p>查看core文件是否开启：</p> <p><em>root@luo:~/workspace/test/exec\&gt;ulimit -c</em></p> <p><em>0</em></p> <p>设置core文件大小：</p> <p><em>root@luo:~/workspace/test/exec\&gt;ulimit -c 1024</em></p> <p><em>root@luo:~/workspace/test/exec\&gt;ulimit -c</em></p> <p><em>1024</em></p> <p>查看core文件路径：</p> <p><em>root@luo:~/workspace/test/exec\&gt;cat /proc/sys/kernel/core_pattern</em></p> <p><em>/SE/core-%e-%p</em></p> <p><em>root@luo:~/workspace/test/exec\&gt;ls /SE</em></p> <p><em>ai core--22330 core--4231 log ngtp_agent web_disk</em></p> <p><em>core--21300 core--23374 core--5227 mysql mp.log</em></p> <p>执行程序，生成core文件：</p> <p><em>root@luo:~/workspace/test/exec\&gt;./test6</em></p> <p><em>Segmentation fault (core dumped)</em></p> <p>查看是否生成core文件：</p> <p><em>root@luo:~/workspace/test/exec\&gt;ls /SE</em></p> <p><em>ai core--23374 core-test6-44938 ngtp_agent</em></p> <p><em>core--21300 core--4231 log mp.log</em></p> <p><em>core--22330 core--5227 mysql web_disk</em></p> <p>使用GDB调试：</p> <p><em>root@luo:~/workspace/test/exec\&gt;gdb -q test6 /SE/core-test6-44938</em></p> <p><em>Reading symbols from /home/luo/workspace/test/exec/test6...done.</em></p> <p><em>[New LWP 44938]</em></p> <p><em>Core was generated by `./test6'.</em></p> <p><em>Program terminated with signal 11, Segmentation fault.</em></p> <p><em>#0 0x0000000000400554 in sub () at test6.c:12</em></p> <p><em>12  printf(&quot;%d&quot;, *p);</em></p> <p><em>(gdb) bt -------------</em> 显示栈信息</p> <p><em>#0 0x0000000000400554 in sub () at test6.c:12</em></p> <p><em>#1 0x0000000000400539 in main () at test6.c:5</em></p> <p><em>(gdb)</em></p> <p>可以看到最后入栈的是sub函数里、位于test6.c文件第12行。所以core dump的问题可能出在这里。</p> <h1 id="_10-gdb调试"><a href="#_10-gdb调试" class="header-anchor">#</a> 10 gdb调试</h1> <h2 id="_10-1-命令介绍"><a href="#_10-1-命令介绍" class="header-anchor">#</a> 10.1 命令介绍</h2> <p>gdb脚本基于gdb命令实现，可在虚拟机和设备上直接运行。使用此脚本可批量对多个进程执行给定命令，也可以调试-i指定的非进程。</p> <table><thead><tr><th>命令</th> <th>gdb</th></tr></thead> <tbody><tr><td>命令格式</td> <td>gdb [-s|-p] [-w] [-F 'SEPERATOR'] [-i '_PIDS'] [-e '_PIDS'] -c|-f 'CMD_ARGS'</td></tr> <tr><td>参数说明</td> <td>-s 串行执行CMD（依次对每个执行CMD；默认选项） -p 并行执行CMD（同时对每个执行CMD） -w 等待所有上都执行CMD完毕，否则任意执行完CMD都将停止其他上的执行（仅对-p有效） -i 使用指定的 pids（多个pid以空格分隔），若不指定则自动扫描所有进程 -e 剔除指定的 pids（多个pid以空格分隔） -c 命令列表（多条命令以';'或-F指定的分隔符进行分隔） -f 命令文件（对于带有分支、循环等复杂控制的多条命令，推荐采用命令文件形式） -F 命令列表中的分隔符（默认为';'）</td></tr></tbody></table> <h2 id="_10-2-使用示例"><a href="#_10-2-使用示例" class="header-anchor">#</a> 10.2 使用示例</h2> <ol><li><p>获取mempool状态。（PID应为master或nae的pid）</p> <p>gdb -c 'call rte_mempool_list_dump(stdout)' -i &lt;PID&gt;</p> <p>gdb -c 'call cfg_callback_test_coredump(0,0)' -i $pid</p> <p>gdb -c '' -i $pid</p></li> <li><p>临时在指定位置添加打印函数。</p> <p>gdb -p -c 'b test.c:45; commands; echo ----will bug_on----\n; bt; c; end; c'</p></li> <li><p>验证RCU是否执行session释放。</p> <p>gdb -p -c 'handle all noprint nostop; b _free_mobj if mid==session_mobj; commands; info thread; bt; end; c'</p></li> <li><p>显示所有进程的calltrace信息及本地变量。</p> <p>说明：对于多、无断点场景下的私有数据、状态，可串行顺序执行。</p> <p>gdb -c 'bt full'</p></li> <li><p>显示所有进程/线程的calltrace信息。（类似于tdb的info state）</p></li></ol> <p>说明：对于多、无断点场景下的私有数据、状态，可串行顺序执行。</p> <p>gdb -c 'thread apply all bt'</p> <ol><li><p>查看每个进程的私有全局变量engine_id、session_local，并打印CallTrace。</p> <p>gdb -c 'p engine_id; p/x *session_local; bt'</p></li> <li><p>对指定进程11662，在其neigh.c:1235行的BUG_ON(1)处设置断点，生成core文件。</p> <p>说明：这种方式生成的core文件不同于由内核生成的/SE/core--PID，它含有共享内存的绝大部分数据，便于深入分析。须注意的是这种core文件一般较大，可能达到几个GB，因此要保证足够的存储空间；存储可能需要十几秒或几十秒。若不指定文件名，则在当前目录下生成名为core.PID的core文件（此时可提前cd到/SE下）。</p> <p>gdb -c 'b neigh.c:1235; commands; silent; gcore /home/luo/workspace/core-neigh.11662; c; end; c' -i 11662</p></li> <li><p>对指定进程11662，在其ut函数处设置断点，每个报文到来则打印tbuf信息。</p></li></ol> <p>说明：对单个进程，不存在串行/并行的区别，可按串行处理。</p> <p>gdb -c 'b ut; commands; silent; p/x *tbuf; c; end; c' -i 11662</p> <ol><li>打开分片重组部分的调试开关debug_ip4_frag_recv、debug_ip4_mtu_send。</li></ol> <p>说明：这两个变量都为共享数据，只需设置单个即可，如pid为11662。</p> <p>gdb -c 'set debug_ip4_frag_recv=1; set debug_ip4_mtu_send=1; printf &quot;recv=%d,send=%d&quot;,debug_ip4_frag_recv,debug_ip4_mtu_send' -i 11662</p> <ol><li>对所有进程设置条件指令断点，触发后执行指定命令，执行命令后继续执行不退出。</li></ol> <p>说明：对于涉及多的有断点场景，应使用并行模式。</p> <p>gdb -p -c 'b test.c:22 if cnt%6==4; commands; silent; echo --trace--\n; bt; printf &quot;\nname=%s cnt=%d\n&quot;, name, cnt; c; end; c'</p> <p>该命令序列也可写入命令文件：（-f /tmp/a.gdb）</p> <p>handle all noprint nostop</p> <p>b test.c:22 if cnt%6==4</p> <p>commands</p> <p>silent</p> <p>echo --trace--\n</p> <p>bt</p> <p>printf &quot;\nname=%s cnt=%d\n&quot;, name, cnt</p> <p>c</p> <p>end</p> <p>c</p> <p>[注]：最后的c命令，使得设完断点及commands后继续运行，倒数第二条c命令，使得断点触发/处理后仍继续运行。</p> <ol><li><p>对所有进程设置数据断点，当数值被改变时，打印CallTrace。</p> <p>说明：watch可监控数据是否被改变，rwatch可监控数据是否被读取，awatch包括这两类。</p> <p>gdb -p -c 'watch st.age; commands; bt; end; c; c'</p></li> <li><p>对每个设置多个断点，每个断点触发时打印CallTrace及文件/函数/行信息。</p> <p>说明：每个断点对应自己的触发处理，此处采用了自定义命令hit_me的方式。</p> <p>gdb -p -f /tmp/b.gdb</p> <p>handle all noprint nostop</p> <p>define hit_me</p> <p>echo \n&gt;&gt;&gt;hit_me&gt;&gt;&gt;\n</p> <p>bt</p> <p>info thread</p> <p>end</p> <p>b test.c:24</p> <p>commands</p> <p>hit_me</p> <p>c</p> <p>end</p> <p>b test.c:36</p> <p>commands</p> <p>hit_me</p> <p>c</p> <p>end</p> <p>c</p></li> <li><p>查看phy_dev[]中ifindex为26的结构体。</p> <p>说明：phy_dev为共享数据，因此只需查看单个即可，如pid为11662。命令序列略繁，可写入命令文件。</p> <p>gdb -f /tmp/dev.gdb -i 11662</p> <p>脚本/tmp/dev.gdb内容如下：</p> <p>handle all noprint nostop</p> <p>set print pretty</p> <p>set $idx=26</p> <p>set $i=0</p> <p>while ($i&lt;256)</p> <p>set $d = (struct dev*)phy_dev[$i]</p> <p>if ($d == 0)</p> <p>loop_break</p> <p>end</p> <p>if ($d-&gt;ifindex==$idx)</p> <p>p/x *$d</p> <p>loop_break</p> <p>end</p> <p>set $i = $i+1</p> <p>end</p></li> <li><p>查看挂接在链表mirror_filter_list上的每个filter节点。</p></li></ol> <p>说明：mirror_filter_list为共享数据，因此只需查看单个即可，如pid为11662。</p> <p>gdb -f /tmp/mirror_filter.gdb -i 11662</p> <p>脚本mirror_filter.gdb内容如下：</p> <p>handle all noprint nostop</p> <p>set print pretty</p> <p>p/x &amp;mirror_filter_list</p> <p>set $f=mirror_filter_list.next</p> <p>while (1)</p> <p>if ($f==&amp;mirror_filter_list)</p> <p>echo [end of list]</p> <p>loop_break</p> <p>end</p> <p>p/x *(struct mirror_filter_t*)$f</p> <p>set $f=((struct list_head*)$f)-&gt;next</p> <p>end</p> <ol><li><p>获取进程core大小限制。</p> <p>gdb -c 'p getrlimit(4,$rsp-32); x/2xg $rsp-32'</p></li></ol></div></section> <footer class="page-edit"><!----> <!----></footer> <!----> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:0;" data-v-cb1513f6></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/assets/js/app.72629fdf.js" defer></script><script src="/assets/js/3.5a4097ad.js" defer></script><script src="/assets/js/1.e2979132.js" defer></script><script src="/assets/js/13.d8a01b18.js" defer></script>
  </body>
</html>
